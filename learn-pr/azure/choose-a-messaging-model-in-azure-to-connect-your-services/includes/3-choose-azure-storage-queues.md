<span data-ttu-id="018d5-101">Angenommen, Sie planen die Architektur einer Anwendung für den Austausch von Musik.</span><span class="sxs-lookup"><span data-stu-id="018d5-101">Suppose you are planning the architecture for your music-sharing application.</span></span> <span data-ttu-id="018d5-102">Dabei möchten Sie sicherstellen, dass Musikdateien in die zuverlässige Web-API der mobilen App hochgeladen wird. Anschließend sollen die Details zu neuen Liedern der Musiker direkt an die App weitergegeben werden.</span><span class="sxs-lookup"><span data-stu-id="018d5-102">You want to ensure that music files are uploaded to the web API reliably from the mobile app - we then want to deliver the details about new songs direct to the app when an artist adds new music to their collection.</span></span> <span data-ttu-id="018d5-103">In einem solchen Szenario eignet sich ein nachrichtenbasiertes System besonders gut. Azure bietet dafür zwei Lösungen:</span><span class="sxs-lookup"><span data-stu-id="018d5-103">This is a perfect use of a message-based system and Azure offers two solutions to this problem:</span></span>

- <span data-ttu-id="018d5-104">Azure Queue Storage</span><span class="sxs-lookup"><span data-stu-id="018d5-104">Azure Queue Storage</span></span>
- <span data-ttu-id="018d5-105">Azure Service Bus</span><span class="sxs-lookup"><span data-stu-id="018d5-105">Azure Service Bus</span></span>

## <a name="what-is-azure-queue-storage"></a><span data-ttu-id="018d5-106">Was ist Azure Queue Storage?</span><span class="sxs-lookup"><span data-stu-id="018d5-106">What is Azure Queue Storage?</span></span>
<span data-ttu-id="018d5-107">Bei Queue Storage handelt es sich um einen Dienst, der Azure Storage verwendet, um eine große Menge von Nachrichten zu speichern, auf die von überall auf der Welt über eine einfache REST-basierte Schnittstelle zugegriffen werden kann.</span><span class="sxs-lookup"><span data-stu-id="018d5-107">Queue storage is a service that uses Azure Storage to store large numbers of messages that can be securely accessed from anywhere in the world using a simple REST-based interface.</span></span> <span data-ttu-id="018d5-108">Warteschlangen können Millionen von Nachrichten enthalten. Die Anzahl an gespeicherten Nachrichten wird nur durch das jeweilige zugewiesene Speicherkonto begrenzt.</span><span class="sxs-lookup"><span data-stu-id="018d5-108">Queues can contain millions of messages, limited only by the capacity of the storage account that owns it.</span></span>

## <a name="what-is-azure-service-bus"></a><span data-ttu-id="018d5-109">Was ist Azure Service Bus?</span><span class="sxs-lookup"><span data-stu-id="018d5-109">What is Azure Service Bus?</span></span>
<span data-ttu-id="018d5-110">Bei Azure Service Bus handelt es sich um ein Brokersystem für Nachrichten, das auf Unternehmensanwendungen ausgerichtet ist.</span><span class="sxs-lookup"><span data-stu-id="018d5-110">Service Bus is a message broker system intended for enterprise applications.</span></span> <span data-ttu-id="018d5-111">Diese Apps verwenden häufig mehrere Kommunikationsprotokolle, verfügen über verschiedene Datenverträge, höhere Sicherheitsanforderungen und können sowohl lokale Dienste als auch Clouddienste umfassen.</span><span class="sxs-lookup"><span data-stu-id="018d5-111">These apps often utilize multiple communication protocols, have different data contracts, higher security requirements, and can include both cloud and on-premises services.</span></span> <span data-ttu-id="018d5-112">Service Bus unterstützt dedizierte Infrastrukturen für Nachrichten, die genau für solche Szenarios konzipiert sind.</span><span class="sxs-lookup"><span data-stu-id="018d5-112">Service Bus is built on top of a dedicated messaging infrastructure designed for exactly these scenarios.</span></span>

<span data-ttu-id="018d5-113">Beide Dienste basieren auf der Idee einer „Warteschlange“, die solange mehrere gesendete Nachrichten enthält, bis der Empfänger bereit ist, diese zu empfangen.</span><span class="sxs-lookup"><span data-stu-id="018d5-113">Both of these services are based on the idea of a "queue" which holds sent messages until the target is ready to receive them.</span></span> <span data-ttu-id="018d5-114">Wenn Sie noch nie mit einem Warteschlangensystem für Nachrichten gearbeitet haben, sollten Sie sich über deren zahlreichen Vorteile informieren. Diese werden im Folgenden erläutert.</span><span class="sxs-lookup"><span data-stu-id="018d5-114">If you've never worked with a message queue system before, they have several convenient benefits.</span></span>

## <a name="increased-reliability"></a><span data-ttu-id="018d5-115">Erhöhte Zuverlässigkeit</span><span class="sxs-lookup"><span data-stu-id="018d5-115">Increased reliability</span></span>
<span data-ttu-id="018d5-116">Warteschlangen werden von verteilten Anwendungen als temporäre Speicherorte für Nachrichten verwendet, deren Zustellung an eine Zielkomponente noch aussteht.</span><span class="sxs-lookup"><span data-stu-id="018d5-116">Queues are used by distributed applications as a temporary storage locations for messages pending delivery to a destination component.</span></span> <span data-ttu-id="018d5-117">Die Quellkomponente kann eine Nachrichten zu der Warteschlange hinzufügen, und die Zielkomponenten können die Nachrichten vorne in der Warteschlange abrufen, um diese zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="018d5-117">The source component can add a message to the queue and destination components can retrieve the message at the front of the queue for processing.</span></span> <span data-ttu-id="018d5-118">Warteschlangen erhöhen die Zuverlässigkeit des Nachrichtenaustauschs, da in Zeiten hoher Nachfrage Nachrichten einfach warten können, bis eine Zielkomponente bereit ist, diese zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="018d5-118">Queues increase the reliability of the message exchange because, at times of high demand, messages can simply wait until a destination component is ready to process them.</span></span>

## <a name="message-delivery-guarantees"></a><span data-ttu-id="018d5-119">Übermittlungsgarantien für Nachrichten</span><span class="sxs-lookup"><span data-stu-id="018d5-119">Message delivery guarantees</span></span>
<span data-ttu-id="018d5-120">Warteschlangensysteme garantieren in der Regel die Zustellung jeder Nachricht in der Warteschlange an eine Zielkomponente.</span><span class="sxs-lookup"><span data-stu-id="018d5-120">Queuing systems usually guarantee delivery of each message in the queue to a destination component.</span></span> <span data-ttu-id="018d5-121">Allerdings können dabei unterschiedliche Ansätze verfolgt werden:</span><span class="sxs-lookup"><span data-stu-id="018d5-121">However, these guarantees can take different approaches:</span></span>

- <span data-ttu-id="018d5-122">**At-Least-Once-Übermittlung**</span><span class="sxs-lookup"><span data-stu-id="018d5-122">**At-Least-Once Delivery.**</span></span> <span data-ttu-id="018d5-123">Bei diesem Ansatz wird jede Nachricht an mindestens eine der Komponenten übermittelt, die Nachrichten aus der Warteschlange abrufen.</span><span class="sxs-lookup"><span data-stu-id="018d5-123">In this approach, each message is guaranteed to be delivered to at least one of the components that retrieve messages from the queue.</span></span> <span data-ttu-id="018d5-124">Unter Umständen ist es jedoch möglich, dass dieselbe Nachricht mehrfach übermittelt wird.</span><span class="sxs-lookup"><span data-stu-id="018d5-124">Note, however, that in certain circumstances, it is possible that the same message may be delivered more than once.</span></span> <span data-ttu-id="018d5-125">Wenn beispielsweise zwei Instanzen einer Webanwendung Nachrichten aus einer Warteschlange abrufen, geht jede Nachricht in der Regel nur an eine dieser Instanzen.</span><span class="sxs-lookup"><span data-stu-id="018d5-125">For example, if there are two instances of a web app retrieving messages from a queue, ordinarily each message goes to only one of those instances.</span></span> <span data-ttu-id="018d5-126">Wenn eine Instanz jedoch lange zum Verarbeiten der Nachrichten braucht, und ein Timeout abläuft, wird die Nachricht ggf. an die andere Instanz gesendet.</span><span class="sxs-lookup"><span data-stu-id="018d5-126">However, if one instance takes a long time to process the message, and a time-out expires, the message may be sent to the other instance as well.</span></span> <span data-ttu-id="018d5-127">Behalten Sie diese Möglichkeit im Hinterkopf, wenn Sie Ihren Web-App-Code entwickeln.</span><span class="sxs-lookup"><span data-stu-id="018d5-127">Your web app code should be designed with this possibility in mind.</span></span>

- <span data-ttu-id="018d5-128">**At-Most-Once-Zustellung.**</span><span class="sxs-lookup"><span data-stu-id="018d5-128">**At-Most-Once Delivery.**</span></span> <span data-ttu-id="018d5-129">Bei diesem Ansatz wird nicht garantiert, dass jede Nachricht übermittelt wird. Es besteht daher die sehr geringe Wahrscheinlichkeit, dass eine Nachricht nicht ankommt.</span><span class="sxs-lookup"><span data-stu-id="018d5-129">In this approach, each message is not guaranteed to be delivered, and there is a very small chance that it may not arrive.</span></span> <span data-ttu-id="018d5-130">Allerdings kann es anders als bei der „At-Least-Once-Übermittlung“ nicht vorkommen, dass Nachrichten mehrmals übermittelt werden.</span><span class="sxs-lookup"><span data-stu-id="018d5-130">However, unlike At-Least-Once delivery, there is no chance that the message will be delivered twice.</span></span> <span data-ttu-id="018d5-131">Dies wird teilweise auch als „automatische Duplikaterkennung“ bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="018d5-131">This is sometimes referred to as "automatic duplicate detection".</span></span>

- <span data-ttu-id="018d5-132">**First In, First Out (FIFO).**</span><span class="sxs-lookup"><span data-stu-id="018d5-132">**First-In-First-Out (FIFO).**</span></span> <span data-ttu-id="018d5-133">In den meisten Messaging-Systemen verlassen Nachrichten die Warteschlange in der Regel in der Reihenfolge, in der sie hinzugefügt wurden. Allerdings sollten Sie überprüfen, ob diese Reihenfolge eingehalten wird.</span><span class="sxs-lookup"><span data-stu-id="018d5-133">In most messaging systems, messages usually leave the queue in the same order in which they were added, but you should consider whether this order is guaranteed.</span></span> <span data-ttu-id="018d5-134">Wenn Ihre verteilte Anwendung verlangt, dass Nachrichten genau in der richtigen Reihenfolge verarbeitet werden, müssen Sie ein Warteschlangensystem mit FIFO-Garantie verwenden.</span><span class="sxs-lookup"><span data-stu-id="018d5-134">If your distributed application requires that messages are processed in precisely the correct order, you must choose a queue system that includes a FIFO guarantee.</span></span>

## <a name="transactional-support"></a><span data-ttu-id="018d5-135">Transaktionsunterstützung</span><span class="sxs-lookup"><span data-stu-id="018d5-135">Transactional support</span></span>
<span data-ttu-id="018d5-136">Einige eng verwandte Nachrichtengruppen können Probleme verursachen, wenn die Übermittlung einer Nachricht in der Gruppe fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="018d5-136">Some closely related groups of messages may cause problems when delivery fails for one message in the group.</span></span>

<span data-ttu-id="018d5-137">Nehmen Sie als Beispiel eine E-Commerce-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="018d5-137">For example, consider an e-commerce application.</span></span> <span data-ttu-id="018d5-138">Wenn der Benutzer auf die Schaltfläche **Kaufen** klickt, werden möglicherweise mehrere Nachrichten generiert und an verschiedene Ziele zur Verarbeitung gesendet:</span><span class="sxs-lookup"><span data-stu-id="018d5-138">When the user clicks the **Buy** button, a series of messages might be generated and sent off to various processing destinations:</span></span>

- <span data-ttu-id="018d5-139">Eine Nachricht mit den Details zur Bestellung wird an das Versandzentrum gesendet.</span><span class="sxs-lookup"><span data-stu-id="018d5-139">A message with the order details is sent to a fulfillment center</span></span>
- <span data-ttu-id="018d5-140">Ein Nachricht mit den Details zur Gesamtsumme und der Bezahlung wird an einen Dienst zur Verarbeitung von Kreditkarteninformationen gesendet.</span><span class="sxs-lookup"><span data-stu-id="018d5-140">A message with the total and payment details is sent to a credit card processor.</span></span> 
- <span data-ttu-id="018d5-141">Eine Nachricht mit den Rechnungsinformationen wird an eine Datenbank gesendet, damit eine Rechnung für den Kunden generiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="018d5-141">A message with the receipt information is sent to a database to generate an invoice for the customer</span></span>

<span data-ttu-id="018d5-142">In diesem Fall soll sichergestellt werden, dass entweder _alle_ Nachrichten oder keine verarbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="018d5-142">In this case, we want to make sure _all_ messages get processed, or none of them are processed.</span></span> <span data-ttu-id="018d5-143">Ihre Anwendung wird wahrscheinlich nicht lange verwendet, wenn die Nachricht zu den Kreditkarteninformationen nicht zugestellt wird und alle Bestellungen zwar versandt, aber nicht bezahlt werden.</span><span class="sxs-lookup"><span data-stu-id="018d5-143">We won't be in business long if the credit card message is not delivered, and all our orders are fulfilled without payment!</span></span> <span data-ttu-id="018d5-144">Solche Probleme können Sie vermeiden, indem Sie die beiden Nachrichten in einer Transaktion zusammenfassen.</span><span class="sxs-lookup"><span data-stu-id="018d5-144">You can avoid these kinds of problems by grouping the two messages into a transaction.</span></span> <span data-ttu-id="018d5-145">Nachrichtentransaktionen sind genauso wie bei Datenbanken immer als einzelne Einheit erfolgreich oder schlagen alle gemeinsam fehl.</span><span class="sxs-lookup"><span data-stu-id="018d5-145">Message transactions succeed or fail as a single unit - just like in the database world.</span></span> <span data-ttu-id="018d5-146">Wenn die Übermittlung der Kreditkartendaten fehlschlägt, gilt dasselbe für die Nachricht mit den Details zur Bestellung.</span><span class="sxs-lookup"><span data-stu-id="018d5-146">If the credit card details message delivery fails, then so will the order details message.</span></span>

## <a name="which-service-should-i-choose"></a><span data-ttu-id="018d5-147">Welcher Dienst eignet sich für mich?</span><span class="sxs-lookup"><span data-stu-id="018d5-147">Which service should I choose?</span></span>
<span data-ttu-id="018d5-148">Ihnen sollte klar sein, dass die Kommunikationsstrategie für diese Art von Architektur auf Nachrichten aufbauen sollte. Wenn dem so ist, können Sie entscheiden, ob Sie Azure Storage Queues oder Azure Service Bus verwenden möchten. Beide Dienste können verwendet werden, um Nachrichten zu speichern und an Ihre Komponenten zuzustellen.</span><span class="sxs-lookup"><span data-stu-id="018d5-148">Having understood that the communication strategy for this architecture should be a message, you must choose whether to use Azure Storage queues or Azure Service Bus, both of which can be used to store and deliver messages between your components.</span></span> <span data-ttu-id="018d5-149">Beide weisen geringfügig unterschiedliche Funktionsmerkmale auf. Das heißt, Sie können sich für einen entscheiden oder beide verwenden. Welche Sie auswählen, hängt von dem zu lösenden Problem ab.</span><span class="sxs-lookup"><span data-stu-id="018d5-149">Each has a slightly different feature set, which means you can choose one or the other, or use both, depending on the problem you are solving.</span></span>

#### <a name="choose-service-bus-queues-if"></a><span data-ttu-id="018d5-150">Verwenden Sie Service Bus-Warteschlangen, wenn Folgendes zutrifft:</span><span class="sxs-lookup"><span data-stu-id="018d5-150">Choose Service Bus queues if:</span></span>
- <span data-ttu-id="018d5-151">Sie benötigen eine At-Most-Once-Zustellungsgarantie.</span><span class="sxs-lookup"><span data-stu-id="018d5-151">You need an At-Most-Once delivery guarantee.</span></span>
- <span data-ttu-id="018d5-152">Sie benötigen eine FIFO-Garantie.</span><span class="sxs-lookup"><span data-stu-id="018d5-152">You need a FIFO guarantee.</span></span>
- <span data-ttu-id="018d5-153">Sie müssen Nachrichten in Transaktionen gruppieren.</span><span class="sxs-lookup"><span data-stu-id="018d5-153">You need to group messages into transactions.</span></span>
- <span data-ttu-id="018d5-154">Sie möchten Nachrichten empfangen, ohne die Warteschlange abzufragen.</span><span class="sxs-lookup"><span data-stu-id="018d5-154">You want to receive messages without polling the queue.</span></span>
- <span data-ttu-id="018d5-155">Sie müssen ein rollenbasiertes Zugriffsmodell für die Warteschlange bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="018d5-155">You need to provide a role-based access model to the queues.</span></span>
- <span data-ttu-id="018d5-156">Sie müssen Nachrichten mit einer Größe von 64 bis 256 KB verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="018d5-156">You need to handle messages larger than 64 KB but less than 256 KB.</span></span>
- <span data-ttu-id="018d5-157">Die Warteschlangengröße liegt unter 80 GB.</span><span class="sxs-lookup"><span data-stu-id="018d5-157">Your queue size will not grow larger than 80 GB.</span></span>
- <span data-ttu-id="018d5-158">Sie möchten in der Lage sein, Nachrichtenbatches zu veröffentlichen und zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="018d5-158">You would like to be able to publish and consume batches of messages.</span></span>

<span data-ttu-id="018d5-159">Queue Storage verfügt über weniger Features. Wenn dies aber für Ihre Anforderungen ausreichend, ist es deutlich einfacher für Sie, wenn Sie diesen Dienst wählen.</span><span class="sxs-lookup"><span data-stu-id="018d5-159">Queue storage isn't quite as feature-rich, but of you don't need any of those features, it can be a simpler choice.</span></span> <span data-ttu-id="018d5-160">Außerdem stellt er die bessere Lösung dar, wenn Ihre App die folgenden Anforderungen stellt:</span><span class="sxs-lookup"><span data-stu-id="018d5-160">In addition, it's the best solution if your app has any of the following requirements.</span></span>

#### <a name="choose-queue-storage-if"></a><span data-ttu-id="018d5-161">Verwenden Sie Queue Storage, wenn Folgendes zutrifft:</span><span class="sxs-lookup"><span data-stu-id="018d5-161">Choose Queue storage if:</span></span>
- <span data-ttu-id="018d5-162">Sie benötigen serverseitige Protokolle aller Nachrichten, die die Warteschlange passieren.</span><span class="sxs-lookup"><span data-stu-id="018d5-162">You need an audit trail of all messages that pass through the queue.</span></span>
- <span data-ttu-id="018d5-163">Sie gehen davon aus, dass die Größe der Warteschlange 80 GB überschreitet.</span><span class="sxs-lookup"><span data-stu-id="018d5-163">You expect the queue to exceed 80 GB in size.</span></span>
- <span data-ttu-id="018d5-164">Sie möchten den Verarbeitungsfortschritt einer Nachricht von der Anwendung innerhalb der Warteschlange nachverfolgen lassen.</span><span class="sxs-lookup"><span data-stu-id="018d5-164">You want to track progress for processing a message inside of the queue.</span></span>

## <a name="summary"></a><span data-ttu-id="018d5-165">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="018d5-165">Summary</span></span>

<span data-ttu-id="018d5-166">Eine Warteschlange ist ein einfacher temporärer Speicherort für Nachrichten, die zwischen Komponenten einer verteilten Anwendung gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="018d5-166">A queue is a simple, temporary storage location for messages sent between the components of a distributed application.</span></span> <span data-ttu-id="018d5-167">Mit Warteschlangen können Sie Nachrichten organisieren und unvorhersehbare Nachfragespitzen bewältigen.</span><span class="sxs-lookup"><span data-stu-id="018d5-167">Use a queue to organize messages and gracefully handle unpredictable surges in demand.</span></span>

<span data-ttu-id="018d5-168">Verwenden Sie Azure Storage-Warteschlangen, wenn Sie ein einfaches und leicht zu codierendes Warteschlangensystem wünschen.</span><span class="sxs-lookup"><span data-stu-id="018d5-168">Use Storage queues when you want a simple and easy-to-code queue system.</span></span> <span data-ttu-id="018d5-169">Nutzen Sie für anspruchsvollere Anforderungen Service Bus-Warteschlangen.</span><span class="sxs-lookup"><span data-stu-id="018d5-169">For more advanced needs, use Service Bus queues.</span></span>