<span data-ttu-id="0071c-101">In manchen Fällen müssen Sie sicherstellen, dass mehrere Vorgänge gemeinsam ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="0071c-101">There are times when you must guarantee that multiple operations execute together.</span></span> <span data-ttu-id="0071c-102">In Ihrer Instant Messaging-Anwendung können Benutzer beispielsweise ein einzelnes Bild, eine individuelle Textnachricht oder ein Bild und eine Textnachricht zusammen senden.</span><span class="sxs-lookup"><span data-stu-id="0071c-102">For example, in your instant messaging application, users can send an individual picture, an individual text message, or a picture and text message together.</span></span> <span data-ttu-id="0071c-103">Wenn der Benutzer sich dafür entscheidet, ein Bild und eine Textnachricht zusammen zu senden, müssen Sie sicherstellen, dass andere Mitglieder der Gruppe beide Elemente gleichzeitig empfangen.</span><span class="sxs-lookup"><span data-stu-id="0071c-103">When the user chooses to send a picture and text message together, you must ensure that other members of the group receive them at the same time.</span></span> <span data-ttu-id="0071c-104">Dies ist wichtig, denn wenn ein Bild und eine Textnachricht nicht zusammen empfangen werden, ist es möglich, dass eine andere Nachricht zwischen dem Bild und der Textnachricht gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="0071c-104">This is important because if a picture and text message are not received together, it’s possible that a separate message could be sent in between the picture and text message.</span></span> <span data-ttu-id="0071c-105">Dadurch könnte die gesamte Unterhaltung verwirrend werden.</span><span class="sxs-lookup"><span data-stu-id="0071c-105">That could make the overall conversation confusing.</span></span>

<span data-ttu-id="0071c-106">Im Folgenden wird erläutert, wie Sie eine Transaktion in Azure Redis Cache erstellen, um sicherzustellen, dass mehrere Vorgänge gemeinsam ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="0071c-106">Here, we'll look at how to create a transaction in Azure Redis Cache to guarantee that multiple operations are executed together.</span></span>

## <a name="creating-and-running-transactions"></a><span data-ttu-id="0071c-107">Erstellen und Ausführen von Transaktionen</span><span class="sxs-lookup"><span data-stu-id="0071c-107">Creating and running transactions</span></span>

<span data-ttu-id="0071c-108">Bei Transaktionen werden in Redis mehrere Befehle, die als Gruppe ausgeführt werden sollen, in eine Warteschlange gereiht.</span><span class="sxs-lookup"><span data-stu-id="0071c-108">Transactions in Redis work by queueing multiple commands to be executed as a group.</span></span> <span data-ttu-id="0071c-109">Wenn eine Transaktion ausgeführt wird, werden die in der Warteschlange enthaltenen Befehle ausgeführt, ohne dass sich andere Befehle von anderen Clients mit diesen überlappen.</span><span class="sxs-lookup"><span data-stu-id="0071c-109">When a transaction is executed, the commands queued inside of it are guaranteed to execute without any other commands from other clients interleaved between them.</span></span>

<span data-ttu-id="0071c-110">Um einen Transaktionsblock zu starten, geben Sie den Befehl `MULTI` ein.</span><span class="sxs-lookup"><span data-stu-id="0071c-110">To begin a transaction block, enter the `MULTI` command.</span></span> <span data-ttu-id="0071c-111">Es werden weitere Befehle in die Warteschlange gereiht, jedoch nicht sofort ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="0071c-111">Further commands will be queued and not executed immediately.</span></span> <span data-ttu-id="0071c-112">Durch Ausführen des Befehls `EXEC` werden alle Befehle in der Warteschlange als Transaktionseinheit ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="0071c-112">Running the `EXEC` command will execute all of the queued commands as a transactional unit.</span></span> <span data-ttu-id="0071c-113">Wenn Sie eine offene Transaktion beim Einfügen von Befehlen in eine Warteschlange abbrechen möchten, wird durch den Befehl `DISCARD` der Transaktionsblock geschlossen, _ohne_ dass die Befehle in der Warteschlange ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="0071c-113">If you decide you want to abort an open transaction while queuing commands, running the `DISCARD` command will close the transaction block without running _any_ of the queued commands.</span></span>

<span data-ttu-id="0071c-114">Redis-Transaktionen unterstützen nicht das Konzept eines Rollbacks.</span><span class="sxs-lookup"><span data-stu-id="0071c-114">Redis transactions do not support the concept of rollback.</span></span> <span data-ttu-id="0071c-115">Wenn Sie einen Befehl mit einer falschen Syntax in einen Transaktionsblock in die Warteschlange reihen, bleibt der Block geöffnet, wird jedoch automatisch verworfen, wenn Sie versuchen, ihn mit `EXEC` auszuführen.</span><span class="sxs-lookup"><span data-stu-id="0071c-115">If you queue a command with incorrect syntax into a transaction block, the block will remain open, but will automatically be discarded if you attempt to execute it with `EXEC`.</span></span> <span data-ttu-id="0071c-116">Wenn bei Befehlen in einer Transaktion, bei denen _während_ der Ausführung (nach Aufruf von `EXEC`) ein Fehler auftritt, wird eine Transaktion weder abgebrochen noch ein Rollback für diese ausgeführt. Redis führt weiterhin alle Befehle aus und betrachtet die Transaktion als erfolgreich abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="0071c-116">Commands in a transaction that fail _during_ execution (after `EXEC` is called) do not cause a transaction to be aborted or rolled back &mdash; Redis will still run all of the commands and consider the transaction to have completed successfully.</span></span>

## <a name="redis-transactions-with-servicestackredis"></a><span data-ttu-id="0071c-117">Redis-Transaktionen mit ServiceStack.Redis</span><span class="sxs-lookup"><span data-stu-id="0071c-117">Redis transactions with ServiceStack.Redis</span></span>

<span data-ttu-id="0071c-118">**ServiceStack.Redis** ist eine C#-Clientbibliothek für die Interaktion mit Azure Redis Cache.</span><span class="sxs-lookup"><span data-stu-id="0071c-118">**ServiceStack.Redis** is a C# client library for interacting with Azure Redis Cache.</span></span>

<span data-ttu-id="0071c-119">Transaktionen in ServiceStack.Redis werden durch Aufrufen von `IRedisClient.CreateTransaction()` erstellt.</span><span class="sxs-lookup"><span data-stu-id="0071c-119">Transactions in ServiceStack.Redis are created by calling `IRedisClient.CreateTransaction()`.</span></span> <span data-ttu-id="0071c-120">Bei dem Objekt `IRedisTransaction`, das zurückgegeben wird, können darin mehrere Befehle mit `QueueCommand()` in der Warteschlange eingereiht sein.</span><span class="sxs-lookup"><span data-stu-id="0071c-120">The `IRedisTransaction` object that is returned can have multiple commands queued into it with `QueueCommand()`.</span></span> <span data-ttu-id="0071c-121">Durch Aufrufen von `Commit()` für das Transaktionsobjekt wird es ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="0071c-121">Calling `Commit()` on the transaction object will execute it.</span></span>

<span data-ttu-id="0071c-122">`IRedisTransaction`-Objekte können gelöscht werden und stellen automatisch einen `DISCARD`-Befehl aus, wenn diese vor Aufrufen von `Commit()` verworfen werden.</span><span class="sxs-lookup"><span data-stu-id="0071c-122">`IRedisTransaction` objects are disposable, and will automatically issue a `DISCARD` command if disposed before calling `Commit()`.</span></span> <span data-ttu-id="0071c-123">Dieses Feature funktioniert gut mit `using`-Blöcken in C#: Wenn Sie eine Transaktion aus irgendeinem Grund nicht committen sollten, wird die Transaktion automatisch verworfen, damit die Redis-Verbindung weiterhin genutzt werden kann.</span><span class="sxs-lookup"><span data-stu-id="0071c-123">This feature works well with C#'s `using` blocks: if you don't commit a transaction for any reason, you can trust that the transaction will automatically be discarded so that the Redis connection can continue to be used.</span></span>

## <a name="create-a-transaction-using-c-and-the-servicestackredis-client"></a><span data-ttu-id="0071c-124">Erstellen einer Transaktion mit C# und dem ServiceStack.Redis-Client</span><span class="sxs-lookup"><span data-stu-id="0071c-124">Create a transaction using C# and the ServiceStack.Redis client</span></span>

<span data-ttu-id="0071c-125">Das folgende Beispiel zeigt die Verwendung von ServiceStack.Redis zum Erstellen einer Transaktion, die eine Nachricht senden kann, die eine Bild-URL und den Inhalt einer Textnachricht enthält.</span><span class="sxs-lookup"><span data-stu-id="0071c-125">Here's an example of using ServiceStack.Redis to create a transaction that can send a message that includes a picture URL and the contents of a text message.</span></span>

```csharp
public bool SendPictureAndText(string groupChatID, string text, string pictureURL)
{
    bool transactionResult = false;

    using (RedisClient redisClient = new RedisClient(redisConnectionString))
    using (var transaction = redisClient.CreateTransaction())
    {
        //Add multiple operations to the transaction
        transaction.QueueCommand(c => c.PublishMessage(groupChatID, pictureURL));
        transaction.QueueCommand(c => c.PublishMessage(groupChatID, text));

        //Commit and get result of transaction
        transactionResult = transaction.Commit();
    }

    return transactionResult;
}
```

<span data-ttu-id="0071c-126">Transaktionen stellen sicher, dass mehrere Vorgänge zusammen ohne Vorgänge von anderen Clients zwischen diesen ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="0071c-126">Transactions ensure that multiple operations are executed together without operations from other clients in between them.</span></span> <span data-ttu-id="0071c-127">Sie können eine Transaktion mit dem Befehl `MULTI` erstellen.</span><span class="sxs-lookup"><span data-stu-id="0071c-127">You create a transaction using the `MULTI` command.</span></span> <span data-ttu-id="0071c-128">Bei ServiceStack.Redis verwenden Sie die Methode `CreateTransaction()`.</span><span class="sxs-lookup"><span data-stu-id="0071c-128">With ServiceStack.Redis, you use the `CreateTransaction()` method.</span></span>