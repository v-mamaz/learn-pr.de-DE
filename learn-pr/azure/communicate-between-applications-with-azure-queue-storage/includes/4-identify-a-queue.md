<span data-ttu-id="9182d-101">Nun, da wir ein Speicherkonto haben, wollen wir uns ansehen, wie wir mit der Warteschlange arbeiten, die darin enthalten sein wird.</span><span class="sxs-lookup"><span data-stu-id="9182d-101">Now that we have a storage account, let's look at how we work with the queue that it will hold.</span></span>

<span data-ttu-id="9182d-102">Um auf eine Warteschlange zugreifen zu können, benötigen Sie drei Informationen:</span><span class="sxs-lookup"><span data-stu-id="9182d-102">To access a queue, you need three pieces of information:</span></span>

 1. <span data-ttu-id="9182d-103">Speicherkontoname</span><span class="sxs-lookup"><span data-stu-id="9182d-103">Storage account name</span></span>
 2. <span data-ttu-id="9182d-104">Warteschlangenname</span><span class="sxs-lookup"><span data-stu-id="9182d-104">Queue name</span></span>
 3. <span data-ttu-id="9182d-105">Autorisierungstoken</span><span class="sxs-lookup"><span data-stu-id="9182d-105">Authorization token</span></span>

<span data-ttu-id="9182d-106">Diese Informationen werden von beiden Anwendungen verwendet, die mit der Warteschlange kommunizieren (dem Web-Front-End, das Nachrichten hinzufügt, und der mittleren Ebene, die sie verarbeitet).</span><span class="sxs-lookup"><span data-stu-id="9182d-106">This information is used by both applications that talk to the queue (the web front end that adds messages and the mid-tier that processes them).</span></span>

## <a name="queue-identity"></a><span data-ttu-id="9182d-107">Identität der Warteschlange</span><span class="sxs-lookup"><span data-stu-id="9182d-107">Queue identity</span></span>

<span data-ttu-id="9182d-108">Jede Warteschlange hat einen Namen, den Sie bei der Erstellung festlegen.</span><span class="sxs-lookup"><span data-stu-id="9182d-108">Every queue has a name that you assign during creation.</span></span> <span data-ttu-id="9182d-109">Der Name muss innerhalb Ihres Speicherkonto eindeutig, aber nicht global eindeutig sein (im Gegensatz zum Namen des Speicherkontos).</span><span class="sxs-lookup"><span data-stu-id="9182d-109">The name must be unique within your storage account but doesn't need to be globally unique (unlike the storage account name).</span></span>

<span data-ttu-id="9182d-110">Die Kombination aus Ihrem Speicherkontonamen und Warteschlangennamen ermöglicht die eindeutige Identifizierung einer Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="9182d-110">The combination of your storage account name and your queue name uniquely identifies a queue.</span></span>

## <a name="access-authorization"></a><span data-ttu-id="9182d-111">Zugriffsautorisierung</span><span class="sxs-lookup"><span data-stu-id="9182d-111">Access authorization</span></span>

<span data-ttu-id="9182d-112">Jede Anforderung an eine Warteschlange muss autorisiert werden, wofür mehrere Optionen zur Auswahl stehen.</span><span class="sxs-lookup"><span data-stu-id="9182d-112">Every request to a queue must be authorized and there are several options to choose from.</span></span>

| <span data-ttu-id="9182d-113">Autorisierungstyp</span><span class="sxs-lookup"><span data-stu-id="9182d-113">Authorization Type</span></span> | <span data-ttu-id="9182d-114">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="9182d-114">Description</span></span> |
|--------------------|-------------|
| <span data-ttu-id="9182d-115">**Azure Active Directory** (AAD)</span><span class="sxs-lookup"><span data-stu-id="9182d-115">**Azure Active Directory**</span></span> | <span data-ttu-id="9182d-116">Sie können die rollenbasierte Authentifizierung verwenden und bestimmte Clients anhand von AAD-Anmeldeinformationen identifizieren.</span><span class="sxs-lookup"><span data-stu-id="9182d-116">you can use role-based authentication and identify specific clients based on AAD credentials.</span></span> |
| <span data-ttu-id="9182d-117">**Gemeinsam verwendeter Schlüssel**</span><span class="sxs-lookup"><span data-stu-id="9182d-117">**Shared Key**</span></span> | <span data-ttu-id="9182d-118">Dies ist eine mitunter als **Kontoschlüssel** bezeichnete verschlüsselte Schlüsselsignatur, die dem Speicherkonto zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="9182d-118">Sometimes referred to as an **account key**, this is an encrypted key signature associated with the storage account.</span></span> <span data-ttu-id="9182d-119">Jedes Speicherkonto verfügt über zwei dieser Schlüssel, die bei jeder Anforderung zur Authentifizierung des Zugriffs übergeben werden können.</span><span class="sxs-lookup"><span data-stu-id="9182d-119">Every storage account has two of these keys that can be passed with each request to authenticate access.</span></span> <span data-ttu-id="9182d-120">Die Befolgung dieses Ansatzes ist wie die Verwendung eines Root-Kennworts und ermöglicht _Vollzugriff_ auf das Speicherkonto.</span><span class="sxs-lookup"><span data-stu-id="9182d-120">Using this approach is like using a root password - it provides _full access_ to the storage account.</span></span> |
| <span data-ttu-id="9182d-121">**Shared Access Signature (SAS)**</span><span class="sxs-lookup"><span data-stu-id="9182d-121">**Shared access signature**</span></span> | <span data-ttu-id="9182d-122">Eine Shared Access Signature (SAS) ist ein generierter URI, der Clients eingeschränkten Zugriff auf Objekte in Ihrem Speicherkonto gewährt.</span><span class="sxs-lookup"><span data-stu-id="9182d-122">A shared access signature (SAS) is a generated URI that grants limited access to objects in your storage account to clients.</span></span> <span data-ttu-id="9182d-123">Sie können den Zugriff auf bestimmte Ressourcen, Berechtigungen und den Umfang auf einen Datenbereich einschränken, um den Zugriff nach einem bestimmten Zeitraum automatisch zu deaktivieren.</span><span class="sxs-lookup"><span data-stu-id="9182d-123">You can restrict access to specific resources, permissions, and scope to a data range to automatically turn off access after a period of time.</span></span>  |

> [!NOTE]
> <span data-ttu-id="9182d-124">Wir werden die Kontoschlüsselautorisierung verwenden, da dies der einfachste Weg ist, mit dem Arbeiten mit Warteschlangen anzufangen. Es wird jedoch empfohlen, in Produktionsanwendungen entweder die Shared Access Signatur (SAS) oder Azure Active Directory (AAD) zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="9182d-124">We will use the account key authorization because it is the simplest way to get started working with queues, however it's recommended that you either use shared access signature (SAS) or Azure Active Directory (AAD) in production apps.</span></span>

### <a name="retrieving-the-account-key"></a><span data-ttu-id="9182d-125">Abrufen des Kontoschlüssels</span><span class="sxs-lookup"><span data-stu-id="9182d-125">Retrieving the account key</span></span>
 
<span data-ttu-id="9182d-126">Ihr Kontoschlüssel ist im Abschnitt **Einstellungen > Zugriffsschlüssel** Ihres Speicherkontos im Azure-Portal verfügbar. Sie können ihn aber auch über die Befehlszeile abrufen:</span><span class="sxs-lookup"><span data-stu-id="9182d-126">Your account key is available in the **Settings > Access keys** section of your storage account in the Azure portal, or you can retrieve it through the command line:</span></span>

```azurecli
az storage account keys list ...
```

```powershell
Get-AzureRmStorageAccountKey ...
```

## <a name="accessing-queues"></a><span data-ttu-id="9182d-127">Zugreifen auf Warteschlangen</span><span class="sxs-lookup"><span data-stu-id="9182d-127">Accessing queues</span></span>

<span data-ttu-id="9182d-128">Sie greifen auf eine Warteschlange über eine REST-API zu.</span><span class="sxs-lookup"><span data-stu-id="9182d-128">You access a queue using a REST API.</span></span> <span data-ttu-id="9182d-129">Dazu verwenden Sie eine URL, die den von Ihnen vergebenen Namen des Speicherkontos mit der Domäne `queue.core.windows.net` und dem Pfad zur Warteschlange kombiniert, mit der Sie arbeiten möchten.</span><span class="sxs-lookup"><span data-stu-id="9182d-129">To do this, you'll use a URL that combines the name you gave the storage account with the domain `queue.core.windows.net` and the path to the queue you want to work with.</span></span> <span data-ttu-id="9182d-130">Beispiel: `http://<storage account>.queue.core.windows.net/<queue name>`.</span><span class="sxs-lookup"><span data-stu-id="9182d-130">For example: `http://<storage account>.queue.core.windows.net/<queue name>`.</span></span> <span data-ttu-id="9182d-131">Ein Header des Typs `Authorization` muss jeder Anforderung hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="9182d-131">An `Authorization` header must be included with every request.</span></span> <span data-ttu-id="9182d-132">Der Wert kann einer der drei Autorisierungsstile sein.</span><span class="sxs-lookup"><span data-stu-id="9182d-132">The value can be any of the three authorization styles.</span></span>

### <a name="using-the-azure-storage-client-library-for-net"></a><span data-ttu-id="9182d-133">Verwenden der Azure Storage-Clientbibliothek für .NET</span><span class="sxs-lookup"><span data-stu-id="9182d-133">Using the Azure Storage Client Library for .NET</span></span>

<span data-ttu-id="9182d-134">Die Azure Storage-Clientbibliothek für .NET ist eine Bibliothek von Microsoft, die REST-Anforderungen formuliert und REST-Antworten für Sie analysiert.</span><span class="sxs-lookup"><span data-stu-id="9182d-134">The Azure Storage Client Library for .NET is a library provided by Microsoft that formulates REST requests and parses REST responses for you.</span></span> <span data-ttu-id="9182d-135">Dadurch verringert sich der Umfang des zu schreibenden Codes erheblich.</span><span class="sxs-lookup"><span data-stu-id="9182d-135">This greatly reduces the amount of code you need to write.</span></span> <span data-ttu-id="9182d-136">Für den Zugriff über die Clientbibliothek werden weiterhin die gleichen Informationen (Speicherkonto- und Warteschlangenname sowie Kontoschlüssel) benötigt, die jedoch unterschiedlich organisiert sind.</span><span class="sxs-lookup"><span data-stu-id="9182d-136">Access using the client library still requires the same pieces of information (storage account name, queue name, and account key); however, they are organized differently.</span></span>

<span data-ttu-id="9182d-137">Die Clientbibliothek verwendet eine **Verbindungszeichenfolge**, um Ihre Verbindung herzustellen.</span><span class="sxs-lookup"><span data-stu-id="9182d-137">The client library uses a **connection string** to establish your connection.</span></span> <span data-ttu-id="9182d-138">Ihre Verbindungszeichenfolge ist im Abschnitt **Einstellungen** Ihres Speicherkontos im Azure-Portal oder über die Azure CLI und PowerShell verfügbar.</span><span class="sxs-lookup"><span data-stu-id="9182d-138">Your connection string is available in the **Settings** section of your Storage Account in the Azure portal, or through the Azure CLI and PowerShell.</span></span>

<span data-ttu-id="9182d-139">Eine Verbindungszeichenfolge ist eine Zeichenfolge, die einen Speicherkontonamen und Kontoschlüssel kombiniert und der Anwendung für den Zugriff auf das Speicherkonto bekannt sein muss.</span><span class="sxs-lookup"><span data-stu-id="9182d-139">A connection string is a string that combines a storage account name and account key and must be known to the application to access the storage account.</span></span> <span data-ttu-id="9182d-140">Das Format ist wie folgt:</span><span class="sxs-lookup"><span data-stu-id="9182d-140">The format looks like this:</span></span>

```csharp
string connectionString = "DefaultEndpointsProtocol=https;AccountName=<your storage account name>;AccountKey=<your key>;EndpointSuffix=core.windows.net"
```

> [!WARNING]
> <span data-ttu-id="9182d-141">Dieser Zeichenfolgenwert muss an einem sicheren Ort gespeichert werden, da jeder mit Zugriff auf diese Verbindungszeichenfolge die Warteschlange manipulieren könnte.</span><span class="sxs-lookup"><span data-stu-id="9182d-141">This string value should be stored in a secure location since anyone who has access to this connection string would be able to manipulate the queue.</span></span>

<span data-ttu-id="9182d-142">Beachten Sie, dass die Verbindungszeichenfolge nicht den Namen der Warteschlange enthält.</span><span class="sxs-lookup"><span data-stu-id="9182d-142">Notice that the connection string doesn't include the queue name.</span></span> <span data-ttu-id="9182d-143">Der Warteschlangenname wird in Ihrem Code bereitgestellt, wenn Sie eine Verbindung mit der Warteschlange herstellen.</span><span class="sxs-lookup"><span data-stu-id="9182d-143">The queue name is supplied in your code when you establish a connection to the queue.</span></span>

<span data-ttu-id="9182d-144">Lassen Sie uns unsere Verbindungszeichenfolge aus Azure abrufen und eine neue Anwendung einrichten, die sie verwendet.</span><span class="sxs-lookup"><span data-stu-id="9182d-144">Let's get our connection string from Azure and set up a new application to use it.</span></span>