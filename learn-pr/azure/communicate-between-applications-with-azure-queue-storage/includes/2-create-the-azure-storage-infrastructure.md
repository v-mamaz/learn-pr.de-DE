<span data-ttu-id="2153b-101">Direkte Kommunikation zwischen den Komponenten einer verteilten Anwendung kann problematisch sein, da sie unterbrochen werden könnte, wenn die Netzwerkbandbreite niedrig oder die Nachfrage hoch ist.</span><span class="sxs-lookup"><span data-stu-id="2153b-101">Direct communication between the components of a distributed application can be problematic because it might be disrupted when network bandwidth is low or when demand is high.</span></span>

<span data-ttu-id="2153b-102">Wir haben in unserem System Folgendes festgestellt: Das Webportal ruft einen Webdienst auf, der einwandfrei funktioniert, wenn der Dienst rechtzeitig reagiert.</span><span class="sxs-lookup"><span data-stu-id="2153b-102">We've seen this in our system: the web portal calls a web service, which works great if the service responds in a timely manner.</span></span> <span data-ttu-id="2153b-103">Hoher Datenverkehr führt zu Problemen, und der Plan ist also, eine Warteschlange zu verwenden, um die direkte Verknüpfung zwischen den Front-End-Apps und Ihrem Webdienst der mittleren Ebene aufzuheben.</span><span class="sxs-lookup"><span data-stu-id="2153b-103">High traffic causes problems and so the plan is to use a queue to eliminate the direct link between the front-end apps and your middle-tier web service.</span></span>

## <a name="what-is-azure-queue-storage"></a><span data-ttu-id="2153b-104">Was ist Azure Queue Storage?</span><span class="sxs-lookup"><span data-stu-id="2153b-104">What is Azure Queue storage?</span></span>

<span data-ttu-id="2153b-105">Azure Queue Storage ist ein Azure-Dienst, der cloudbasierte Warteschlangen implementiert.</span><span class="sxs-lookup"><span data-stu-id="2153b-105">Azure Queue storage is an Azure service that implements cloud-based queues.</span></span> <span data-ttu-id="2153b-106">Jede Warteschlange verwaltet eine Liste von Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="2153b-106">Each queue maintains a list of messages.</span></span> <span data-ttu-id="2153b-107">Anwendungskomponenten greifen mithilfe einer REST-API oder einer von Azure bereitgestellten Clientbibliothek auf eine Warteschlange zu.</span><span class="sxs-lookup"><span data-stu-id="2153b-107">Application components access a queue using a REST API or an Azure-supplied client library.</span></span> <span data-ttu-id="2153b-108">In der Regel verfügen Sie über mindestens eine _Senderkomponente_ und mindestens eine _Empfängerkomponente_.</span><span class="sxs-lookup"><span data-stu-id="2153b-108">Typically, you will have one or more _sender_ components and one or more _receiver_ components.</span></span> <span data-ttu-id="2153b-109">Senderkomponenten fügen der Warteschlange eine Nachricht hinzu.</span><span class="sxs-lookup"><span data-stu-id="2153b-109">Sender components add message to the queue.</span></span> <span data-ttu-id="2153b-110">Empfängerkomponenten rufen Nachrichten am Anfang der Warteschlange zur Verarbeitung ab.</span><span class="sxs-lookup"><span data-stu-id="2153b-110">Receiver components retrieve messages from the front of the queue for processing.</span></span> <span data-ttu-id="2153b-111">Die folgende Abbildung zeigt mehrere Senderanwendungen beim Hinzufügen von Nachrichten zur Azure-Warteschlange und eine Empfängeranwendung beim Abrufen der Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="2153b-111">The following illustration shows multiple sender applications adding messages to the Azure Queue and one receiver application retrieving the messages.</span></span>

![Abbildung der allgemeinen Architektur von Azure Queue Storage](../media/2-queue-overview.png)

<span data-ttu-id="2153b-113">Die Preise basieren auf Größe der Warteschlange und Anzahl der Vorgänge.</span><span class="sxs-lookup"><span data-stu-id="2153b-113">Pricing is based on queue size and number of operations.</span></span> <span data-ttu-id="2153b-114">Größere Nachrichtenwarteschlangen sind teurer als kleinere Warteschlangen.</span><span class="sxs-lookup"><span data-stu-id="2153b-114">Larger message queues cost more than smaller queues.</span></span> <span data-ttu-id="2153b-115">Auch für jeden Vorgang wie Hinzufügen oder Löschen einer Nachricht fallen Gebühren an.</span><span class="sxs-lookup"><span data-stu-id="2153b-115">Charges are also incurred for each operation, such as adding a message and deleting a message.</span></span> <span data-ttu-id="2153b-116">Ausführliche Informationen zu Preisen finden Sie unter [Azure Queue Storage – Preise](https://azure.microsoft.com/pricing/details/storage/queues/).</span><span class="sxs-lookup"><span data-stu-id="2153b-116">For pricing details, see [Azure Queue storage pricing](https://azure.microsoft.com/pricing/details/storage/queues/).</span></span>

## <a name="why-use-queues"></a><span data-ttu-id="2153b-117">Warum sollte ich Warteschlangen verwenden?</span><span class="sxs-lookup"><span data-stu-id="2153b-117">Why use queues?</span></span>

<span data-ttu-id="2153b-118">Eine Warteschlange erhöht die Resilienz durch vorübergehendes Speichern wartender Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="2153b-118">A queue increases resiliency by temporarily storing waiting messages.</span></span> <span data-ttu-id="2153b-119">Bei geringer oder normaler Nachfrage bleibt die Warteschlange klein, weil die Zielkomponente Nachrichten schneller aus der Warteschlange entfernt, als sie hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="2153b-119">At times of low or normal demand, the size of the queue remains small because the destination component removes messages from the queue faster than they are added.</span></span> <span data-ttu-id="2153b-120">Bei hoher Nachfrage wird die Warteschlange möglicherweise größer, aber es gehen keine Nachrichten verloren.</span><span class="sxs-lookup"><span data-stu-id="2153b-120">At times of high demand, the queue may increase in size, but messages are not lost.</span></span> <span data-ttu-id="2153b-121">Die Zielkomponente kann aufholen und die Warteschlange leeren, wenn die Nachfrage zur Normalität zurückkehrt.</span><span class="sxs-lookup"><span data-stu-id="2153b-121">The destination component can catch up and empty the queue as demand returns to normal.</span></span>

<span data-ttu-id="2153b-122">Da eine einzelne Warteschlange bis zu **500TB** groß sein kann, könnte sie potenziell _Millionen_ von Nachrichten speichern.</span><span class="sxs-lookup"><span data-stu-id="2153b-122">A single queue can be up to **500 TB** in size, so it can potentially store _millions_ of messages.</span></span> <span data-ttu-id="2153b-123">Der Zieldurchsatz einer einzelnen Warteschlange beträgt 2.000 Nachrichten pro Sekunde, d.h. sie kann Szenarios mit hohem Volumen behandeln.</span><span class="sxs-lookup"><span data-stu-id="2153b-123">The target throughput for a single queue is 2000 messages per second, allowing it to handle high-volume scenarios.</span></span>

<span data-ttu-id="2153b-124">Warteschlangen ermöglichen Ihrer Anwendung eine automatische und sofortige Skalierung, wenn sich die Nachfrage ändert.</span><span class="sxs-lookup"><span data-stu-id="2153b-124">Queues let your application scale automatically and immediately when demand changes.</span></span> <span data-ttu-id="2153b-125">Darum sind sie so hilfreich bei wichtigen Geschäftsdaten, deren Verlust ein Schaden wäre.</span><span class="sxs-lookup"><span data-stu-id="2153b-125">This makes them useful for critical business data that would be damaging to lose.</span></span> <span data-ttu-id="2153b-126">Azure bietet viele andere Dienste, die automatisch skalieren.</span><span class="sxs-lookup"><span data-stu-id="2153b-126">Azure offers many other services that scale automatically.</span></span> <span data-ttu-id="2153b-127">Das Feature **Autoskalierung** ist z.B. für Azure-VM-Skalierungsgruppen, Clouddienste, Azure App Service-Pläne und App Service-Umgebungen verfügbar.</span><span class="sxs-lookup"><span data-stu-id="2153b-127">For example, the **Autoscale** feature is available on Azure virtual machine scale sets, cloud services, Azure App Service plans, and App Service environments.</span></span> <span data-ttu-id="2153b-128">Damit können Sie Regeln definieren, die Azure verwendet, um Phasen mit hoher Nachfrage zu identifizieren und automatisch ohne Einbeziehung eines Administrators Kapazität hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="2153b-128">This lets you define rules that Azure uses to identify periods of high demand and automatically add capacity without involving an administrator.</span></span> <span data-ttu-id="2153b-129">Autoskalierung reagiert schnell, aber nicht sofort auf die Nachfrage.</span><span class="sxs-lookup"><span data-stu-id="2153b-129">Autoscaling responds to demand quickly, but not instantaneously.</span></span> <span data-ttu-id="2153b-130">Im Gegensatz dazu reagiert Azure Queue Storage sofort auf starke Nachfrage, indem Nachrichten gespeichert werden, bis Verarbeitungsressourcen verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="2153b-130">By contrast, Azure Queue storage instantaneously handles high demand by storing messages until processing resources are available.</span></span>

## <a name="what-is-a-message"></a><span data-ttu-id="2153b-131">Was ist eine Nachricht?</span><span class="sxs-lookup"><span data-stu-id="2153b-131">What is a message?</span></span>

<span data-ttu-id="2153b-132">Eine Nachricht in einer Warteschlange ist ein Bytearray von bis zu 64KB.</span><span class="sxs-lookup"><span data-stu-id="2153b-132">A message in a queue is a byte array of up to 64 KB.</span></span> <span data-ttu-id="2153b-133">Nachrichteninhalte werden von Azure-Komponenten prinzipiell nicht interpretiert.</span><span class="sxs-lookup"><span data-stu-id="2153b-133">Message contents are not interpreted at all by any Azure component.</span></span>

<span data-ttu-id="2153b-134">Wenn Sie eine strukturierte Nachricht erstellen möchten, können Sie den Nachrichteninhalt mit XML oder JSON formatieren.</span><span class="sxs-lookup"><span data-stu-id="2153b-134">If you want to create a structured message, you could format the message content using XML or JSON.</span></span> <span data-ttu-id="2153b-135">Der Code ist für das Generieren und Interpretieren Ihres benutzerdefinierten Formats verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="2153b-135">Your code is responsible for generating and interpreting your custom format.</span></span> <span data-ttu-id="2153b-136">Sie könnten z.B. eine benutzerdefinierte JSON-Nachricht erstellen, die wie folgt aussieht:</span><span class="sxs-lookup"><span data-stu-id="2153b-136">For example, you could make a custom JSON message that looks like the following:</span></span>

```json
{
    "Message": {
        "To": "news@contoso.com",
        "From": "writer@contoso.com",
        "Subject": "Support request",
        "Body": "Send me a photographer!"
    }
}
```

## <a name="creating-a-storage-account"></a><span data-ttu-id="2153b-137">Erstellen eines Speicherkontos</span><span class="sxs-lookup"><span data-stu-id="2153b-137">Creating a storage account</span></span>

<span data-ttu-id="2153b-138">Eine Warteschlange muss zu einem Speicherkonto gehören.</span><span class="sxs-lookup"><span data-stu-id="2153b-138">A queue must be part of a storage account.</span></span> <span data-ttu-id="2153b-139">Sie können ein Speicherkonto über die Azure-Befehlszeilenschnittstelle (oder PowerShell) oder das Azure-Portal erstellen.</span><span class="sxs-lookup"><span data-stu-id="2153b-139">You can create a storage account using the Azure CLI (or PowerShell), or Azure portal.</span></span> <span data-ttu-id="2153b-140">Das Portal ist aufgrund der Benutzerführung am einfachsten, und jede Information wird von Ihnen abgefragt.</span><span class="sxs-lookup"><span data-stu-id="2153b-140">The portal is easiest because it's all guided and prompts you for each piece of information.</span></span> 

<span data-ttu-id="2153b-141">Der folgende Screenshot zeigt den Speicherort der Storage-Kontenkategorie.</span><span class="sxs-lookup"><span data-stu-id="2153b-141">The following screenshot shows the location of the Storage accounts category.</span></span>

![Screenshot des Blatts „Alle Dienste“ mit hervorgehobener Storage-Kontenkategorie.](../media/2-create-storage-account-1.png)

<span data-ttu-id="2153b-143">Wenn Sie das Konto erstellen, können Sie mehrere Optionen angeben, bei denen Sie meist die Standardauswahl verwenden können.</span><span class="sxs-lookup"><span data-stu-id="2153b-143">There are several options you can supply when you create the account, most of which you can use the default selection.</span></span> <span data-ttu-id="2153b-144">Wir haben diese Optionen in einem vorherigen Modul behandelt, aber Sie können den Mauszeiger auf den `(i)`-Tipp setzen, der jeder Option zugeordnet ist, um eine Erinnerung an die Funktion zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="2153b-144">We covered these options in a previous module, but you can hover over the `(i)` tip associated with each option to get a reminder of what it does.</span></span> <span data-ttu-id="2153b-145">Hier ist ein Beispiel für das Ausfüllen des Portalblatts.</span><span class="sxs-lookup"><span data-stu-id="2153b-145">Here's an example of filling out the portal blade.</span></span>

<span data-ttu-id="2153b-146">Der folgende Screenshot zeigt das Blatt „Speicherkonto erstellen“ und die zum Erstellen eines Speicherkontos erforderlichen Informationen.</span><span class="sxs-lookup"><span data-stu-id="2153b-146">The following screenshot displays the Create storage account blade and the information required to create a storage account.</span></span>

![Screenshot des Blatts „Speicherkonto erstellen“ mit den Optionen, die beim Erstellen eines Speicherkontos angegeben werden müssen.](../media/2-create-storage-account-2.png)

### <a name="settings-for-queues"></a><span data-ttu-id="2153b-148">Einstellungen für Warteschlangen</span><span class="sxs-lookup"><span data-stu-id="2153b-148">Settings for queues</span></span>
<span data-ttu-id="2153b-149">Wenn Sie ein Speicherkonto erstellen, das Warteschlangen enthalten soll, sollten Sie die folgenden Einstellungen berücksichtigen:</span><span class="sxs-lookup"><span data-stu-id="2153b-149">When you create a storage account that will contain queues, you should consider the following settings:</span></span>

- <span data-ttu-id="2153b-150">Warteschlangen sind nur als Teil von Azure-Speicherkonten für allgemeine Zwecke (v1 oder v2) verfügbar.</span><span class="sxs-lookup"><span data-stu-id="2153b-150">Queues are only available as part of Azure general-purpose storage accounts (v1 or v2).</span></span> <span data-ttu-id="2153b-151">Sie können sie nicht Blobspeicherkonten hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="2153b-151">You cannot add them to Blob storage accounts.</span></span>
- <span data-ttu-id="2153b-152">Die für StorageV2-Konten angezeigte Einstellung **Zugriffsebene** gilt nur für Blobspeicher und wirkt sich nicht auf Warteschlangen aus.</span><span class="sxs-lookup"><span data-stu-id="2153b-152">The **Access tier** setting which is shown for StorageV2 accounts applies only to Blob storage and does not affect queues.</span></span>
- <span data-ttu-id="2153b-153">Sie sollten einen Speicherort auswählen, der sich entweder in der Nähe der Quell- oder der Zielkomponenten bzw. (vorzugsweise) beider befindet.</span><span class="sxs-lookup"><span data-stu-id="2153b-153">You should choose a location that is close to either the source components or destination components or (preferably) both.</span></span>
- <span data-ttu-id="2153b-154">Daten werden zum Schutz vor Datenträgerfehlern und anderen Hardwareproblemen immer auf mehreren Servern repliziert.</span><span class="sxs-lookup"><span data-stu-id="2153b-154">Data is always replicated to multiple servers to guard against disk failures and other hardware problems.</span></span> <span data-ttu-id="2153b-155">Sie können zwischen verschiedenen Replikationsstrategien wählen: **Lokal redundanter Speicher (Locally Redundant Storage, LRS)** ist kostengünstig, aber anfällig für Notfälle, die ein gesamtes Rechenzentrum betreffen, während **georedundanter Speicher (Geo-Redundant Storage, GRS)** Daten in anderen Azure-Rechenzentren repliziert.</span><span class="sxs-lookup"><span data-stu-id="2153b-155">You have a choice of replication strategies: **Locally Redundant Storage (LRS)** is low-cost but vulnerable to disasters that affect an entire data center while **Geo-Redundant Storage (GRS)** replicates data to other Azure data centers.</span></span> <span data-ttu-id="2153b-156">Wählen Sie die Replikationsstrategie, die Ihre Redundanzanforderungen erfüllt.</span><span class="sxs-lookup"><span data-stu-id="2153b-156">Choose the replication strategy that meets your redundancy needs.</span></span>
- <span data-ttu-id="2153b-157">Die Leistungsstufe bestimmt, wie die Nachrichten gespeichert werden: **Standard** verwendet magnetische Laufwerke, **Premium** Festkörperlaufwerke.</span><span class="sxs-lookup"><span data-stu-id="2153b-157">The performance tier determines how your message are stored: **Standard** uses magnetic drives while **Premium** uses solid-state drives.</span></span> <span data-ttu-id="2153b-158">Wählen Sie „Standard“, wenn Sie kurze Nachfragespitzen erwarten.</span><span class="sxs-lookup"><span data-stu-id="2153b-158">Choose Standard if you expect peaks in demand to be short.</span></span> <span data-ttu-id="2153b-159">Wählen Sie „Premium“, wenn die Warteschlange manchmal lang wird, und Sie die Zeit für den Zugriff auf Nachrichten minimieren müssen.</span><span class="sxs-lookup"><span data-stu-id="2153b-159">Consider Premium if queue length sometimes becomes long and you need to minimize the time to access messages.</span></span>
- <span data-ttu-id="2153b-160">Fordern Sie eine sichere Übertragung, wenn vertrauliche Informationen über die Warteschlange geleitet werden könnten.</span><span class="sxs-lookup"><span data-stu-id="2153b-160">Require secure transfer if sensitive information may pass through the queue.</span></span> <span data-ttu-id="2153b-161">Diese Einstellung stellt sicher, dass alle Verbindungen mit der Warteschlange mithilfe von Secure Sockets Layer (SSL) verschlüsselt werden.</span><span class="sxs-lookup"><span data-stu-id="2153b-161">This setting ensures that all connections to the queue are encrypted using Secure Sockets Layer (SSL).</span></span>
