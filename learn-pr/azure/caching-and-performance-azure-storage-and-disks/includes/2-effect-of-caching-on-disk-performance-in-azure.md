<span data-ttu-id="5d4d5-101">Wir werden die Faktoren betrachten, die Auswirkungen auf die Datenträgerleistung in Azure haben, und wie Zwischenspeichern die Leistung optimieren kann.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-101">We're going to look at the factors that affect disk performance in Azure, and how caching can help optimize performance.</span></span> 

### <a name="disk-caching"></a><span data-ttu-id="5d4d5-102">Datenträgerzwischenspeichern</span><span class="sxs-lookup"><span data-stu-id="5d4d5-102">Disk caching</span></span>

<span data-ttu-id="5d4d5-103">Ein Cache ist eine spezielle Komponente in einem Computer, die Daten speichert, damit schneller darauf zugegriffen werden kann, in der Regel im Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-103">A cache is a specialized component in a computer that stores data so it can be accessed faster, typically in memory.</span></span> <span data-ttu-id="5d4d5-104">Die Daten in einem Cache wurden häufig zuvor gelesen, oder es sind Daten, die aus einer früheren Berechnung stammen.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-104">The data in a cache is often data that has been read previously, or is data that resulted from an earlier calculation.</span></span> <span data-ttu-id="5d4d5-105">Das Ziel ist, schneller auf Daten zuzugreifen, als wenn sie vom Datenträger abgerufen würden.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-105">The goal is to access data faster than getting it from disk.</span></span>

<span data-ttu-id="5d4d5-106">Zum Zwischenspeichern wird spezialisierter und manchmal teurer, temporärer Speicher verwendet, der eine höhere Lese- und/oder Schreibleistung als dauerhafter Speicher aufweist.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-106">Caching uses specialized, and sometimes expensive, temporary storage that has faster read and/or write performance than permanent storage.</span></span> <span data-ttu-id="5d4d5-107">Da dieser Cachespeicher häufig beschränkt ist, muss entschieden werden, welchen Datenvorgängen das Zwischenspeichern am meisten nutzt.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-107">Because this cache storage is often limited, decisions need to be made as to what data operations will benefit most from caching.</span></span> <span data-ttu-id="5d4d5-108">Aber auch wenn der Cache in hohem Maße verfügbar gemacht werden kann wie in Azure, ist es dennoch wichtig, die Workloadmuster der einzelnen Datenträger zu kennen, bevor Sie entscheiden, welcher Cachetyp verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-108">But even where the cache can be made widely available, such as in Azure, it's still important to know the workload patterns of each disk before deciding on what caching type to use.</span></span>

<span data-ttu-id="5d4d5-109">**Zwischenspeichern von Lesevorgängen** soll den Datenabruf beschleunigen.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-109">**Read caching** tries to speed up data retrieval.</span></span> <span data-ttu-id="5d4d5-110">Anstatt aus dem dauerhaften Speicher werden die Daten aus dem schnelleren Cache gelesen.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-110">Instead of reading from permanent storage, the data is read from the faster cache.</span></span> <span data-ttu-id="5d4d5-111">Beim Datenlesen wird der Cache unter den folgenden Bedingungen genutzt.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-111">Data reads hit the cache under the following conditions.</span></span>

- <span data-ttu-id="5d4d5-112">Die Daten wurden zuvor gelesen und sind im Cache vorhanden.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-112">The data has been read before and exists in the cache.</span></span>
- <span data-ttu-id="5d4d5-113">Außerdem ist der Cache groß genug, um alle diese Daten aufzunehmen.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-113">And the cache is large enough to hold all of this data.</span></span>

<span data-ttu-id="5d4d5-114">Beachten Sie unbedingt, dass das Zwischenspeichern Lesevorgänge unterstützt, wenn eine gewisse _Vorhersagbarkeit_ der Lesewarteschlange gegeben ist, wie z.B. bei einem Satz sequenzieller Lesevorgänge.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-114">It's important to note that read caching helps when there is some _predictability_ to the read queue, such as a set of sequential reads.</span></span> <span data-ttu-id="5d4d5-115">Bei zufälliger E/A, wo die Daten, auf die Sie zugreifen, über den ganzen Speicher verteilt sind, bietet das Zwischenspeichern wenige oder gar keine Vorteile und kann sogar die Datenträgerleistung reduzieren.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-115">For random IO, where the data you're accessing is scattered across storage, caching will be of little or no benefit, and can even reduce disk performance.</span></span>

<span data-ttu-id="5d4d5-116">**Zwischenspeichern von Schreibvorgängen** versucht, das Schreiben von Daten in den Speicher zu beschleunigen.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-116">**Write caching** tries to speed up writing data to storage.</span></span> <span data-ttu-id="5d4d5-117">Bei Verwendung eines Schreibcaches kann die App die zu speichernden Daten in Betracht ziehen.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-117">By using a write cache, the app can consider the data to be saved.</span></span> <span data-ttu-id="5d4d5-118">In der Praxis werden die Daten im Cache in eine Warteschlange eingereiht, um in den permanenten Speicher geschrieben zu werden.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-118">In reality, the data is queued up in a cache waiting to be written to permanent storage.</span></span> <span data-ttu-id="5d4d5-119">Wie Sie sich vorstellen können, kann dieser Mechanismus eine potenzielle Fehlerquelle sein, wenn das System heruntergefahren wird, bevor diese zwischengespeicherten Daten auf den Datenträger geschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-119">As you can imagine, this mechanism can be a potential point of failure, if the system shuts down before this cached data is flushed to disk.</span></span> <span data-ttu-id="5d4d5-120">Einige Systeme, z.B. SQL Server, regeln das Schreiben zwischengespeicherter Daten in den permanenten Datenträgerspeicher selbst.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-120">Some systems, such as SQL Server, handle writing cached data to persistent disk storage themselves.</span></span>  

### <a name="azure-disk-caching"></a><span data-ttu-id="5d4d5-121">Azure-Datenträgerzwischenspeichern</span><span class="sxs-lookup"><span data-stu-id="5d4d5-121">Azure disk caching</span></span>

<span data-ttu-id="5d4d5-122">Es gibt zwei Arten des Datenträgerzwischenspeicherns, die Datenträgerspeicher betreffen:</span><span class="sxs-lookup"><span data-stu-id="5d4d5-122">There are two types of disk caching that concern disk storage:</span></span>

- <span data-ttu-id="5d4d5-123">Azure-Datenträgerzwischenspeichern</span><span class="sxs-lookup"><span data-stu-id="5d4d5-123">Azure storage caching</span></span>
- <span data-ttu-id="5d4d5-124">Azure-VM-Datenträgerzwischenspeichern</span><span class="sxs-lookup"><span data-stu-id="5d4d5-124">Azure virtual machine disk caching</span></span>

<span data-ttu-id="5d4d5-125">Azure-Datenträgerzwischenspeichern stellt Cachedienste für Azure Blob Storage, Azure Files und andere Inhalte in Azure bereit.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-125">Azure storage caching provides cache services for Azure Blob storage, Azure Files, and other content in Azure.</span></span> <span data-ttu-id="5d4d5-126">Die Konfiguration dieser Arten von Cache ist nicht Gegenstand dieses Moduls.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-126">Configuration of these types of cache is beyond the scope of this module.</span></span>

<span data-ttu-id="5d4d5-127">Azure-VM-Datenträgerzwischenspeichern dient zum Optimieren der Lese- und Schreibzugriffe auf die Dateien der virtuellen Festplatte (Virtual Hard Disk, VHD), die Azure-VMs angefügt sind.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-127">Azure virtual machine disk caching is about optimizing read and write access to the virtual hard disk (VHD) files attached to Azure VMs.</span></span> <span data-ttu-id="5d4d5-128">Wir konzentrieren uns in diesem Modul auf das Datenträgerzwischenspeichern.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-128">We'll focus on disk caching in this module.</span></span>

### <a name="azure-virtual-machine-disk-types"></a><span data-ttu-id="5d4d5-129">Azure-VM-Datenträgertypen</span><span class="sxs-lookup"><span data-stu-id="5d4d5-129">Azure virtual machine disk types</span></span>

<span data-ttu-id="5d4d5-130">Mit virtuellen Azure-Computern (VMs) werden drei Typen von Datenträgern verwendet.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-130">There are three types of disks used with Azure virtual machines (VM).</span></span>

- <span data-ttu-id="5d4d5-131">**Betriebssystem-Datenträger**: Wenn Sie eine Azure-VM erstellen, fügt Azure automatisch eine virtuelle Festplatte für das Betriebssystem (Operating System, OS) an.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-131">**OS disk**: When you create an Azure VM, Azure automatically attaches a VHD for the operating system (OS).</span></span> <span data-ttu-id="5d4d5-132">Die virtuelle Festplatte wird als Seitenblob im Azure-Speicher gespeichert.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-132">The VHD is stored as a page blob in Azure storage.</span></span>
- <span data-ttu-id="5d4d5-133">**Temporärer Datenträger**: Wenn Sie eine Azure-VM erstellen, fügt Azure auch automatisch einen temporären Datenträger hinzu.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-133">**Temporary disk**: When you create an Azure VM, Azure also automatically adds a temporary disk.</span></span> <span data-ttu-id="5d4d5-134">Dieser Datenträger wird für Daten verwendet, z.B. Auslagerungsdateien.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-134">This disk is used for data such as page and swap files.</span></span> <span data-ttu-id="5d4d5-135">Die Daten auf diesem Datenträger können während der Wartung oder erneuten Bereitstellung eines virtuellen Computers verloren gehen.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-135">The data on this disk may be lost during maintenance or a VM redeploy.</span></span> <span data-ttu-id="5d4d5-136">Verwenden Sie diesen Datenträger nicht zum Speichern dauerhafter Daten, z.B. Datenbankdateien oder Transaktionsprotokolle.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-136">So, don't use it for storing permanent data, such as database files or transaction logs.</span></span>
- <span data-ttu-id="5d4d5-137">**Datenträger**: Ein Datenträger ist eine VHD, die zum Speichern von Anwendungsdaten oder anderen Daten, die Sie aufbewahren müssen, an einen virtuellen Computer angebunden ist.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-137">**Data disks**: A data disk is a VHD that's attached to a virtual machine to store application data, or other data you need to keep.</span></span>

<span data-ttu-id="5d4d5-138">Betriebssystem-Datenträger und Datenträger für Daten nutzen Azure-VM-Datenträgerzwischenspeichern.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-138">OS disks and data disks take advantage of Azure VM disk caching.</span></span> <span data-ttu-id="5d4d5-139">Die Cachegröße für einen VM-Datenträger hängt von der Größe der VM-Instanz und der Anzahl der Datenträger ab, die auf dem virtuellen Computer bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-139">The cache size for a VM disk depends on the VM instance size and on the number of disks mounted on the VM.</span></span> <span data-ttu-id="5d4d5-140">Das Zwischenspeichern kann nur für bis zu vier Datenträger für Daten aktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-140">Caching can only be enabled for up to four data disks.</span></span>

## <a name="cache-options-for-azure-vms"></a><span data-ttu-id="5d4d5-141">Cacheoptionen für Azure-VMs</span><span class="sxs-lookup"><span data-stu-id="5d4d5-141">Cache options for Azure VMs</span></span>

<span data-ttu-id="5d4d5-142">Es gibt drei allgemeine Optionen für das VM-Datenträgerzwischenspeichern.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-142">There are three common options for VM disk caching.</span></span>

- <span data-ttu-id="5d4d5-143">**Lese-/Schreibzugriff** – Zurückschreibcache.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-143">**Read/write** – write back cache.</span></span>  <span data-ttu-id="5d4d5-144">Verwenden Sie diese Option nur, wenn Ihre Anwendung das Schreiben von zwischengespeicherten Daten auf persistente Datenträger bei Bedarf ordnungsgemäß verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-144">Only use this option if your application properly handles writing cached data to persistent disks when needed</span></span>
- <span data-ttu-id="5d4d5-145">**Schreibgeschützt** – Lesevorgänge aus dem Cache werden ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-145">**Read-only** - reads are performed from cache.</span></span>
- <span data-ttu-id="5d4d5-146">**Keine** – kein Cache.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-146">**None** - no cache.</span></span> <span data-ttu-id="5d4d5-147">Wählen Sie diese Option für lesegeschützte und schreibintensive Datenträger.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-147">Select this option for write-only and write-heavy disks.</span></span> <span data-ttu-id="5d4d5-148">Protokolldateien sind gute Kandidaten, da sie mit schreibintensiven Vorgängen verbunden sind.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-148">Log files are a good candidate since they're write-heavy operations.</span></span>

<span data-ttu-id="5d4d5-149">Nicht jede Option zum Zwischenspeichern ist für jeden Datenträgertyp verfügbar.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-149">Not every caching option is available for each type of disk.</span></span> <span data-ttu-id="5d4d5-150">Die folgende Tabelle zeigt die Optionen zum Zwischenspeichern für die einzelnen Datenträgertypen:</span><span class="sxs-lookup"><span data-stu-id="5d4d5-150">The following table shows you the caching options for each disk type:</span></span>

| |<span data-ttu-id="5d4d5-151">**Schreibgeschützt**</span><span class="sxs-lookup"><span data-stu-id="5d4d5-151">**Read-only**</span></span>  |<span data-ttu-id="5d4d5-152">**Lesen/Schreiben**</span><span class="sxs-lookup"><span data-stu-id="5d4d5-152">**Read/write**</span></span>  |<span data-ttu-id="5d4d5-153">**Keine**</span><span class="sxs-lookup"><span data-stu-id="5d4d5-153">**None**</span></span>  |
|---------|---------|---------|---------|
|<span data-ttu-id="5d4d5-154">Betriebssystem-Datenträger</span><span class="sxs-lookup"><span data-stu-id="5d4d5-154">OS disk</span></span>     |   <span data-ttu-id="5d4d5-155">Ja</span><span class="sxs-lookup"><span data-stu-id="5d4d5-155">yes</span></span>      |   <span data-ttu-id="5d4d5-156">Ja (Standard)</span><span class="sxs-lookup"><span data-stu-id="5d4d5-156">yes (default)</span></span>     |   <span data-ttu-id="5d4d5-157">Ja</span><span class="sxs-lookup"><span data-stu-id="5d4d5-157">yes</span></span>      |
|<span data-ttu-id="5d4d5-158">Datenträger</span><span class="sxs-lookup"><span data-stu-id="5d4d5-158">Data disk</span></span>     |   <span data-ttu-id="5d4d5-159">Ja (Standard)</span><span class="sxs-lookup"><span data-stu-id="5d4d5-159">yes (default)</span></span>      |  <span data-ttu-id="5d4d5-160">Ja</span><span class="sxs-lookup"><span data-stu-id="5d4d5-160">yes</span></span>       |  <span data-ttu-id="5d4d5-161">Ja</span><span class="sxs-lookup"><span data-stu-id="5d4d5-161">yes</span></span>       |
|<span data-ttu-id="5d4d5-162">Temporärer Datenträger</span><span class="sxs-lookup"><span data-stu-id="5d4d5-162">Temporary disk</span></span>     |  <span data-ttu-id="5d4d5-163">Nein</span><span class="sxs-lookup"><span data-stu-id="5d4d5-163">no</span></span>       |   <span data-ttu-id="5d4d5-164">Nein</span><span class="sxs-lookup"><span data-stu-id="5d4d5-164">no</span></span>      |   <span data-ttu-id="5d4d5-165">Nein</span><span class="sxs-lookup"><span data-stu-id="5d4d5-165">no</span></span>      |

> [!NOTE]
> <span data-ttu-id="5d4d5-166">Datenträgerzwischenspeicher-Optionen können für virtuelle Computer der L- und B-Serie nicht geändert werden.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-166">Disk caching options can't be changed for L-Series and B-series virtual machines.</span></span>

## <a name="performance-considerations-for-azure-vm-disk-caching"></a><span data-ttu-id="5d4d5-167">Überlegungen zur Leistung für das Azure-VM-Datenträgerzwischenspeichern</span><span class="sxs-lookup"><span data-stu-id="5d4d5-167">Performance considerations for Azure VM disk caching</span></span>

<span data-ttu-id="5d4d5-168">Wie können Ihre Cacheeinstellungen die Leistung Ihrer auf Azure-VMs ausgeführten Workloads beeinträchtigen?</span><span class="sxs-lookup"><span data-stu-id="5d4d5-168">So how can your cache settings affect the performance of your workloads running on Azure VMs?</span></span>

### <a name="os-disk"></a><span data-ttu-id="5d4d5-169">Betriebssystem-Datenträger</span><span class="sxs-lookup"><span data-stu-id="5d4d5-169">OS disk</span></span>

<span data-ttu-id="5d4d5-170">Standardmäßig wird der Cache für einen VM-Betriebssystem-Datenträger im Lese-/Schreibzugriffsmodus verwendet.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-170">For a VM OS disk, the default behavior is to use the cache in Read/write mode.</span></span> <span data-ttu-id="5d4d5-171">Wenn Ihre Anwendungen Datendateien auf dem Betriebssystem-Datenträger speichern, und die Anwendungen zahlreiche wahlfreie Lese-/Schreib-Vorgänge in Datendateien ausführen, sollten Sie in Betracht ziehen, diese Dateien auf einen Datenträger für Daten zu verschieben, für den das Zwischenspeichern deaktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-171">If you have applications that store data files on the OS disk, and the applications do lots of random read/write operations to data files, consider moving those files to a data disk, which has the caching turned off.</span></span> <span data-ttu-id="5d4d5-172">Warum? Wenn die Lesewarteschlange keine sequenziellen Lesevorgänge enthält, hat das Zwischenspeichern wenig oder keinen Vorteil.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-172">Why is that Well, if the read queue does not contain sequential reads, caching will be of little or no benefit.</span></span> <span data-ttu-id="5d4d5-173">Der Mehraufwand für die Verwaltung des Caches, als wären die Daten sequenziell, kann die Datenträgerleistung reduzieren.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-173">The overhead of maintaining the cache, as if the data was sequential, can reduce disk performance.</span></span>

### <a name="data-disks"></a><span data-ttu-id="5d4d5-174">Datenträger für Daten</span><span class="sxs-lookup"><span data-stu-id="5d4d5-174">Data disks</span></span>

<span data-ttu-id="5d4d5-175">Für leistungsabhängige Anwendungen sollten Sie Datenträger für Daten statt des Betriebssystem-Datenträgers verwenden.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-175">For performance sensitive applications, you should use data disks, rather than the OS disk.</span></span> <span data-ttu-id="5d4d5-176">Mithilfe von separaten Datenträgern können Sie die entsprechenden Cacheeinstellungen für jeden Datenträger konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-176">Using separate disks allows you to configure the appropriate cache settings for each disk.</span></span>

<span data-ttu-id="5d4d5-177">Beispielsweise kann auf Azure-VMs, die SQL Server ausführen, das Aktivieren des **schreibgeschützten** Zwischenspeicherns auf den Datenträgern für Daten (für reguläre und TempDB-Daten) zu erheblichen Leistungsverbesserungen führen.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-177">For example, on Azure VMs running SQL Server, enabling **Read-only** caching on the data disks (for regular and TempDB data), can result in significant performance improvements.</span></span> <span data-ttu-id="5d4d5-178">Protokolldateien sind auf der anderen Seite gute Kandidaten für Datenträger für Daten ohne Zwischenspeichern.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-178">Log files, on the other hand, are good candidates for data disks with no caching.</span></span>

> [!WARNING]
> <span data-ttu-id="5d4d5-179">Durch Ändern der Cacheeinstellung eines Azure-Datenträgers wird der Zieldatenträger getrennt und erneut angefügt.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-179">Changing the cache setting of an Azure disk detaches and re-attaches the target disk.</span></span> <span data-ttu-id="5d4d5-180">Wenn es sich um den Betriebssystemdatenträger handelt, wird der virtuelle Computer neu gestartet.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-180">If it's the operating system disk, the VM is restarted.</span></span> <span data-ttu-id="5d4d5-181">Beenden Sie alle Anwendungen und Dienste, die von dieser Unterbrechung betroffen sein könnten, bevor Sie die Cacheeinstellung des Datenträgers ändern.</span><span class="sxs-lookup"><span data-stu-id="5d4d5-181">Stop all applications/services that might be affected by this disruption before changing the disk cache setting.</span></span>
>
>