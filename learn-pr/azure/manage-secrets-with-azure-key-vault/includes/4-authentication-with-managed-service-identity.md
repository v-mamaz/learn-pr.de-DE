<span data-ttu-id="f3224-101">Azure Key Vault verwendet **Azure Active Directory** zum Authentifizieren von Benutzern und Anwendungen, die versuchen, auf einen Tresor zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="f3224-101">Azure Key Vault uses **Azure Active Directory** to authenticate users and applications that try to access a vault.</span></span> <span data-ttu-id="f3224-102">Um unserer Webanwendung Zugriff auf den Tresor zu gewähren, müssen wir unsere App zunächst bei Azure Active Directory registrieren.</span><span class="sxs-lookup"><span data-stu-id="f3224-102">To grant our web application access to the vault, we first need to register our app with Azure Active Directory.</span></span> <span data-ttu-id="f3224-103">Bei der Registrierung wird eine Identität für die App erstellt.</span><span class="sxs-lookup"><span data-stu-id="f3224-103">Registering creates an identity for the app.</span></span> <span data-ttu-id="f3224-104">Sobald eine Identität vorliegt, können wir ihr Tresorberechtigungen zuweisen.</span><span class="sxs-lookup"><span data-stu-id="f3224-104">Once we have an identity, we can assign vault permissions to it.</span></span>

<span data-ttu-id="f3224-105">Anwendungen und Benutzer authentifizieren sich bei Key Vault mit einem Azure Active Directory-Authentifizierungstoken.</span><span class="sxs-lookup"><span data-stu-id="f3224-105">Apps and users authenticate to Key Vault using an Azure Active Directory authentication token.</span></span> <span data-ttu-id="f3224-106">Um ein Token von Azure Active Directory zu beziehen, ist ein Geheimnis oder Zertifikat erforderlich, da jeder mit einem Token die Anwendungsidentität verwenden kann, um auf alle Geheimnisse im Tresor zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="f3224-106">Getting a token from Azure Active Directory requires a secret or certificate, because anyone with a token could use the application identity to access all of the secrets in the vault.</span></span>

<span data-ttu-id="f3224-107">Unsere Anwendungsgeheimnisse sind im Tresor sicher, aber wir benötigen trotzdem noch ein Geheimnis oder Zertifikat außerhalb des Tresors, um darauf zugreifen zu können!</span><span class="sxs-lookup"><span data-stu-id="f3224-107">Our application secrets are secure in the vault, but we still need to keep a secret or certificate outside of the vault in order to access them!</span></span> <span data-ttu-id="f3224-108">Dieses Problem wird *Bootstrapping* genannt, wofür Azure allerdings eine Lösung hat.</span><span class="sxs-lookup"><span data-stu-id="f3224-108">This problem is called the *bootstrapping problem*, and Azure has a solution for it.</span></span>

## <a name="managed-service-identity"></a><span data-ttu-id="f3224-109">Verwaltete Dienstidentität</span><span class="sxs-lookup"><span data-stu-id="f3224-109">Managed Service Identity</span></span>

<span data-ttu-id="f3224-110">*Verwaltete Dienstidentität* (Managed Service Identity, MSI) ist ein Feature von Azure App Service, mit dem Ihre App auf Key Vault und andere Azure-Dienste zugreifen kann, ohne selbst ein Geheimnis verwalten zu müssen.</span><span class="sxs-lookup"><span data-stu-id="f3224-110">*Managed Service Identity* (MSI) is a feature of Azure App Service that your app can use to access Key Vault and other Azure services without having to manage even a single secret.</span></span> <span data-ttu-id="f3224-111">Die Verwendung von MSI ist einfacher und sicherer als die Verwaltung eines Geheimnisses durch Sie.</span><span class="sxs-lookup"><span data-stu-id="f3224-111">Using MSI is simpler and more secure than managing a secret yourself.</span></span>

<span data-ttu-id="f3224-112">Wenn Sie MSI aktivieren, aktiviert Azure einen separaten ein Token gewährenden REST-Dienst speziell für Ihre Anwendung.</span><span class="sxs-lookup"><span data-stu-id="f3224-112">When you enable MSI, Azure activates a separate token-granting REST service specifically for use by your app.</span></span> <span data-ttu-id="f3224-113">Wenn Ihre Anwendung ein Token vom MSI-Tokendienst anfordert, kontaktiert der Dienst Azure Active Directory, um ein Token für die MSI-Identität zu beziehen, das an Ihre Anwendung zur Verwendung mit Key Vault zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="f3224-113">When your app requests a token from the MSI token service, the service contacts Azure Active Directory to get a token for the MSI identity and hands it back to your app for use with Key Vault.</span></span> <span data-ttu-id="f3224-114">Der wichtigste Teil dieses Workflows ist die Art und Weise, in der sich Ihre Anwendung beim MSI-Tokendienst authentifiziert. Anstatt ein Geheimnis oder Zertifikat zu benötigen, das Sie in Ihrer Konfiguration verwalten müssen, verwendet Ihre Anwendung ein Geheimnis, das Azure beim Start sicher in seine Umgebungsvariablen einfügt.</span><span class="sxs-lookup"><span data-stu-id="f3224-114">The most important part of this workflow is the way that your app authenticates to the MSI token service &mdash; instead of requiring a secret or certificate you need to manage in your configuration, your app uses a secret that Azure securely injects into its environment variables when it starts up.</span></span> <span data-ttu-id="f3224-115">Sie müssen diesen geheimen Wert nirgendwo mehr verwalten oder speichern.</span><span class="sxs-lookup"><span data-stu-id="f3224-115">You don't need to manage or store this secret value anywhere.</span></span> <span data-ttu-id="f3224-116">Nichts außerhalb Ihrer Anwendung kann auf dieses Geheimnis oder den Endpunkt des MSI-Tokendiensts zugreifen.</span><span class="sxs-lookup"><span data-stu-id="f3224-116">Nothing outside of your app can access this secret or the MSI token service endpoint.</span></span>

<span data-ttu-id="f3224-117">MSI registriert Ihre Anwendung auch für Sie in Azure Active Directory und löscht die Registrierung, sobald Sie MSI deaktivieren oder die Anwendung löschen.</span><span class="sxs-lookup"><span data-stu-id="f3224-117">MSI also registers your app in Azure Active Directory for you, and will delete the registration if you disable MSI or delete the app.</span></span>

<span data-ttu-id="f3224-118">MSI ist in allen Editionen von Azure Active Directory verfügbar, einschließlich der Free Edition, die in einem Azure-Abonnement enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="f3224-118">MSI is available in all editions of Azure Active Directory, including the Free edition included with an Azure subscription.</span></span> <span data-ttu-id="f3224-119">Seine Verwendung in App Service ist kostenlos, erfordert keine Konfiguration und kann jederzeit in einer App aktiviert oder deaktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="f3224-119">Using it in App Service has no extra cost and requires no configuration, and it can be enabled or disabled on an app at any time.</span></span>

> [!NOTE]
> <span data-ttu-id="f3224-120">MSI wird für Linux- oder Container-Web-Apps derzeit nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="f3224-120">MSI is not currently supported for Linux or Container web apps.</span></span>

<span data-ttu-id="f3224-121">Für die Aktivierung von MSI muss nur ein einziger Azure CLI-Befehl ohne Konfiguration ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="f3224-121">Enabling MSI requires only a single Azure CLI command with no configuration.</span></span> <span data-ttu-id="f3224-122">Das machen wir in Einheit 5, wenn wir eine App Service-App einrichten und in Azure bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="f3224-122">We'll do it in unit 5 when we set up an App Service app and deploy to Azure.</span></span> <span data-ttu-id="f3224-123">Vorher werden wir jedoch unser Wissen über MSI nutzen, um den Code für unsere App zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="f3224-123">Before that, though, we're going to apply our knowledge of MSI to write the code for our app.</span></span>