<span data-ttu-id="30a3d-101">Key Vault verwendet **Azure Active Directory** zum Authentifizieren von Benutzern und Anwendungen, die versuchen, einen Tresor zugreifen.</span><span class="sxs-lookup"><span data-stu-id="30a3d-101">Key Vault uses **Azure Active Directory** to authenticate users and applications that try to access a vault.</span></span> <span data-ttu-id="30a3d-102">Um unsere Web-Anwendungszugriff auf den Tresor zu gewähren, müssen wir zuerst unsere app in Azure Active Directory zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="30a3d-102">To grant our web application access to the vault, we first need to register our app with Azure Active Directory.</span></span> <span data-ttu-id="30a3d-103">Registrieren eine Identität für die app erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="30a3d-103">Registering creates an identity for the app.</span></span> <span data-ttu-id="30a3d-104">Sobald wir eine Identität verfügen, können wir es Vault-Berechtigungen zuweisen.</span><span class="sxs-lookup"><span data-stu-id="30a3d-104">Once we have an identity, we can assign vault permissions to it.</span></span>

<span data-ttu-id="30a3d-105">Apps und Benutzer in den Schlüsseltresor verwenden ein Azure Active Directory-Authentifizierungstoken zu authentifizieren.</span><span class="sxs-lookup"><span data-stu-id="30a3d-105">Apps and users authenticate to Key Vault using an Azure Active Directory authentication token.</span></span> <span data-ttu-id="30a3d-106">Abrufen eines Tokens aus Azure Active Directory erfordert einen geheimen Schlüssel oder das Zertifikat, da jeder Benutzer mit einem Token die Identität verwenden kann, alle geheimen Schlüssel im Tresor den Zugriff auf.</span><span class="sxs-lookup"><span data-stu-id="30a3d-106">Getting a token from Azure Active Directory requires a secret or certificate, because anyone with a token could use the application identity to access all of the secrets in the vault.</span></span>

<span data-ttu-id="30a3d-107">Unsere geheime Schlüssel für Anwendungen sind im Tresor sicher, jedoch müssen noch ein Geheimnis oder Zertifikat außerhalb des Tresors zu lassen, um den Zugriff!</span><span class="sxs-lookup"><span data-stu-id="30a3d-107">Our application secrets are secure in the vault, but we still need to keep a secret or certificate outside of the vault in order to access them!</span></span> <span data-ttu-id="30a3d-108">Dieses Problem wird aufgerufen, die *bootstrapping Problem*, und Azure verfügt über eine Lösung dafür.</span><span class="sxs-lookup"><span data-stu-id="30a3d-108">This problem is called the *bootstrapping problem*, and Azure has a solution for it.</span></span>

## <a name="managed-service-identity"></a><span data-ttu-id="30a3d-109">Verwaltete Dienstidentität</span><span class="sxs-lookup"><span data-stu-id="30a3d-109">Managed Service Identity</span></span>

<span data-ttu-id="30a3d-110">*Verwaltete Dienstidentität* (MSI) ist ein Feature von Azure App Service, mit denen Ihre app Key Vault und andere Azure-Dienste zugreifen, ohne selbst einen einzelnen geheimen Schlüssel verwalten zu müssen.</span><span class="sxs-lookup"><span data-stu-id="30a3d-110">*Managed Service Identity* (MSI) is a feature of Azure App Service that your app can use to access Key Vault and other Azure services without having to manage even a single secret.</span></span> <span data-ttu-id="30a3d-111">Mithilfe der MSI-Datei ist einfacher und sicherer als die ein geheimen Schlüssels selbst verwalten.</span><span class="sxs-lookup"><span data-stu-id="30a3d-111">Using MSI is simpler and more secure than managing a secret yourself.</span></span>

<span data-ttu-id="30a3d-112">Wenn Sie MSI aktivieren, aktiviert Azure einen separaten-Token-granting-REST-Dienst speziell für die Verwendung von Ihrer app.</span><span class="sxs-lookup"><span data-stu-id="30a3d-112">When you enable MSI, Azure activates a separate token-granting REST service specifically for use by your app.</span></span> <span data-ttu-id="30a3d-113">Wenn Ihre app ein Token vom Tokendienst MSI-Datei anfordert, wird der Dienst Azure Active Directory zum Abrufen eines Tokens für die MSI-Identität kontaktiert und übergibt es wieder zu Ihrer app für die Verwendung mit Key Vault.</span><span class="sxs-lookup"><span data-stu-id="30a3d-113">When your app requests a token from the MSI token service, the service contacts Azure Active Directory to get a token for the MSI identity and hands it back to your app for use with Key Vault.</span></span> <span data-ttu-id="30a3d-114">Der wichtigste Teil dieses Workflows ist die Möglichkeit, die Ihre app in der MSI-token-Dienst authentifiziert &mdash; benötigen ein Geheimnis oder Zertifikat, die Sie in Ihrer Konfiguration verwalten müssen, nicht Ihre app verwendet einen geheimen Schlüssel, die Azure sicher in fügt die Umgebungsvariablen, wenn sie wird gestartet.</span><span class="sxs-lookup"><span data-stu-id="30a3d-114">The most important part of this workflow is the way that your app authenticates to the MSI token service &mdash; instead of requiring a secret or certificate you need to manage in your configuration, your app uses a secret that Azure securely injects into its environment variables when it starts up.</span></span> <span data-ttu-id="30a3d-115">Sie müssen nicht verwalten oder speichern Sie diesen geheimen Wert an eine beliebige Stelle.</span><span class="sxs-lookup"><span data-stu-id="30a3d-115">You don't need to manage or store this secret value anywhere.</span></span> <span data-ttu-id="30a3d-116">"Nothing" außerhalb Ihrer app kann auf dieses Geheimnis oder den MSI-Sicherheitstoken-Dienstendpunkt zugreifen.</span><span class="sxs-lookup"><span data-stu-id="30a3d-116">Nothing outside of your app can access this secret or the MSI token service endpoint.</span></span>

<span data-ttu-id="30a3d-117">MSI-Datei auch Ihre app in Azure Active Directory für Sie registriert, und die Registrierung wird gelöscht, wenn Sie die MSI-Datei zu deaktivieren oder löschen Sie die app.</span><span class="sxs-lookup"><span data-stu-id="30a3d-117">MSI also registers your app in Azure Active Directory for you, and will delete the registration if you disable MSI or delete the app.</span></span>

<span data-ttu-id="30a3d-118">MSI-Datei ist verfügbar in allen Editionen von Azure Active Directory, einschließlich der kostenlosen Edition, die in einem Azure-Abonnement enthalten.</span><span class="sxs-lookup"><span data-stu-id="30a3d-118">MSI is available in all editions of Azure Active Directory, including the Free edition included with an Azure subscription.</span></span> <span data-ttu-id="30a3d-119">Verwenden sie in App Service verfügt über keine zusätzlichen Kosten und erfordert keine Konfiguration, und es kann aktiviert oder deaktiviert für eine app zu einem beliebigen Zeitpunkt.</span><span class="sxs-lookup"><span data-stu-id="30a3d-119">Using it in App Service has no extra cost and requires no configuration, and it can be enabled or disabled on an app at any time.</span></span>

> [!NOTE]
> <span data-ttu-id="30a3d-120">MSI wird für Linux oder Container-Web-apps derzeit nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="30a3d-120">MSI is not currently supported for Linux or Container web apps.</span></span>

<span data-ttu-id="30a3d-121">Die MSI-Aktivierung erfordert nur einen einzelnen Azure-CLI-Befehl ohne Konfiguration.</span><span class="sxs-lookup"><span data-stu-id="30a3d-121">Enabling MSI requires only a single Azure CLI command with no configuration.</span></span> <span data-ttu-id="30a3d-122">Wir tun dies Einheit 5 Wenn wir eine App Service-app einrichten und in Azure bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="30a3d-122">We'll do it in unit 5 when we set up an App Service app and deploy to Azure.</span></span> <span data-ttu-id="30a3d-123">Davor werden jedoch wir unseren Erkenntnissen der MSI-Datei zum Schreiben von Code für die app angewendet.</span><span class="sxs-lookup"><span data-stu-id="30a3d-123">Before that, though, we're going to apply our knowledge of MSI to write the code for our app.</span></span>