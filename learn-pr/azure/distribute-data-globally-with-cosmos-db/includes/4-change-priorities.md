<span data-ttu-id="e8655-101">Nachdem Sie Ihre Daten in mehreren Regionen repliziert haben, können Sie die automatisierten Failoverlösungen nutzen, die von Azure Cosmos DB bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="e8655-101">Once you've replicated your data in multiple regions, you can take advantage of the automated failover solutions Azure Cosmos DB provides.</span></span> <span data-ttu-id="e8655-102">Automatisierte Failover sind ein Feature, das genutzt wird, wenn eine Katastrophe oder ein anderer Notfall eintritt und eine Ihrer Lese- oder Schreibregionen in den Offlinezustand versetzt wird. Anforderungen werden dann von der Offlineregion an die nächste Region der Prioritätsreihenfolge umgeleitet.</span><span class="sxs-lookup"><span data-stu-id="e8655-102">Automated failover is a feature that comes into play when there's a disaster or other event that takes one of your read or write regions offline, and it redirects requests from the offline region to the next most prioritized region.</span></span> 

<span data-ttu-id="e8655-103">Für Ihre Onlinetextilhandel-Website, die Sie gerade in den Regionen „USA, Osten“, „USA, Westen“ und „Vereinigtes Königreich, Westen“ repliziert haben, können Sie die Priorität wie folgt festlegen: Wenn „USA, Osten“ in den Offlinezustand versetzt wird, können Sie Lesevorgänge an „USA, Westen“ umleiten, anstatt an „Vereinigtes Königreich, Westen“, um die Latenz zu verringern.</span><span class="sxs-lookup"><span data-stu-id="e8655-103">For your online clothing site, which you just replicated into East US, West US, and West UK, you can prioritize that if the East US goes offline, you can redirect reads to West US instead of West UK, to limit latency.</span></span> 

<span data-ttu-id="e8655-104">In dieser Einheit wird beschrieben, wie das Failover funktioniert, und es wird die Priorität für die Regionen festgelegt, in denen die Daten Ihres Unternehmens repliziert wurden.</span><span class="sxs-lookup"><span data-stu-id="e8655-104">In this unit you'll learn about how failover works and set the priority for the regions in which your company's data has been replicated.</span></span>

## <a name="failover-basics"></a><span data-ttu-id="e8655-105">Failovergrundlagen</span><span class="sxs-lookup"><span data-stu-id="e8655-105">Failover basics</span></span>

<span data-ttu-id="e8655-106">Im seltenen Fall des Ausfalls einer Azure-Region oder eines Rechenzentrums löst Azure Cosmos DB automatisch ein Failover aller Azure Cosmos DB-Konten aus, die sich in der betroffenen Region befinden.</span><span class="sxs-lookup"><span data-stu-id="e8655-106">In the rare event of an Azure regional outage or data center outage, Azure Cosmos DB automatically triggers failovers of all Azure Cosmos DB accounts with a presence in the affected region.</span></span>

<span data-ttu-id="e8655-107">**Was passiert beim Ausfall einer Leseregion?**</span><span class="sxs-lookup"><span data-stu-id="e8655-107">**What happens if a read region has an outage?**</span></span>

<span data-ttu-id="e8655-108">Azure Cosmos DB-Konten mit einer Leseregion in einer der betroffenen Regionen werden automatisch von ihrer Schreibregion getrennt und als offline gekennzeichnet.</span><span class="sxs-lookup"><span data-stu-id="e8655-108">Azure Cosmos DB accounts with a read region in one of the affected regions are automatically disconnected from their write region and marked offline.</span></span> <span data-ttu-id="e8655-109">Die Cosmos DB-SDKs implementieren ein Protokoll für die Regionsermittlung, mit dessen Hilfe automatisch erkannt werden kann, wenn eine Region verfügbar ist, und Leseaufrufe an die nächste verfügbar Region in der Liste der bevorzugten Regionen umgeleitet werden können.</span><span class="sxs-lookup"><span data-stu-id="e8655-109">The Cosmos DB SDKs implement a regional discovery protocol that allows them to automatically detect when a region is available and redirect read calls to the next available region in the preferred region list.</span></span> <span data-ttu-id="e8655-110">Wenn keine der Regionen in der Liste verfügbar ist, wird für die Aufrufe automatisch ein Fallback zur aktuellen Schreibregion durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="e8655-110">If none of the regions in the preferred region list is available, calls automatically fall back to the current write region.</span></span> <span data-ttu-id="e8655-111">Zur Verarbeitung regionaler Failover sind keine Änderungen an Ihrem Anwendungscode erforderlich.</span><span class="sxs-lookup"><span data-stu-id="e8655-111">No changes are required in your application code to handle regional failovers.</span></span> <span data-ttu-id="e8655-112">Während des gesamten Prozesses werden die Konsistenzgarantien von Azure Cosmos DB weiterhin erfüllt.</span><span class="sxs-lookup"><span data-stu-id="e8655-112">During this entire process, consistency guarantees continue to be honored by Azure Cosmos DB.</span></span>

<span data-ttu-id="e8655-113">Sobald die betroffene Region nach dem Ausfall wiederhergestellt wurde, werden alle betroffenen Azure Cosmos DB-Konten in der Region vom Dienst automatisch wiederhergestellt.</span><span class="sxs-lookup"><span data-stu-id="e8655-113">Once the affected region recovers from the outage, all the affected Azure Cosmos DB accounts in the region are automatically recovered by the service.</span></span> <span data-ttu-id="e8655-114">Azure Cosmos DB-Konten, die über eine Leseregion in der betroffenen Region verfügen, werden automatisch mit der aktuellen Schreibregion synchronisiert und wieder online geschaltet.</span><span class="sxs-lookup"><span data-stu-id="e8655-114">Azure Cosmos DB accounts that had a read region in the affected region will then automatically sync with current write region and turn online.</span></span> <span data-ttu-id="e8655-115">Die Azure Cosmos DB-SDKs ermitteln die Verfügbarkeit der neuen Region und bewerten anhand der von der Anwendung konfigurierten Liste mit den bevorzugten Regionen, ob die Region als aktuelle Leseregion ausgewählt werden soll.</span><span class="sxs-lookup"><span data-stu-id="e8655-115">The Azure Cosmos DB SDKs discover the availability of the new region and evaluate whether the region should be selected as the current read region based on the preferred region list configured by the application.</span></span> <span data-ttu-id="e8655-116">Nachfolgende Lesevorgänge werden an die wiederhergestellte Region weitergeleitet, ohne dass Änderungen an Ihrem Anwendungscode erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="e8655-116">Subsequent reads are redirected to the recovered region without requiring any changes to your application code.</span></span>

<span data-ttu-id="e8655-117">**Was passiert beim Ausfall einer Schreibregion?**</span><span class="sxs-lookup"><span data-stu-id="e8655-117">**What happens if a write region has an outage?**</span></span>

<span data-ttu-id="e8655-118">Wenn die betroffene Region die aktuelle Schreibregion ist und für das Azure Cosmos DB-Konto die Funktion „Automatisches Failover“ aktiviert ist, wird die Region automatisch als offline gekennzeichnet.</span><span class="sxs-lookup"><span data-stu-id="e8655-118">If the affected region is the current write region and automatic failover is enabled for the Azure Cosmos DB account, then the region is automatically marked as offline.</span></span> <span data-ttu-id="e8655-119">Danach wird eine andere Region zur Schreibregion für das betroffene Cosmos DB-Konto hochgestuft.</span><span class="sxs-lookup"><span data-stu-id="e8655-119">Then, an alternative region is promoted as the write region for the affected Azure Cosmos DB account.</span></span>

<span data-ttu-id="e8655-120">Während eines automatischen Failovers wählt Azure Cosmos DB anhand der angegebenen Prioritätsreihenfolge automatisch die nächste Schreibregion für ein bestimmtes Azure Cosmos DB-Konto aus.</span><span class="sxs-lookup"><span data-stu-id="e8655-120">During automatic failovers, Azure Cosmos DB automatically chooses the next write region for a given Azure Cosmos DB account based on the specified priority order.</span></span> <span data-ttu-id="e8655-121">Anwendungen können die Eigenschaft „WriteEndpoint“ der Klasse „DocumentClient“ verwenden, um eine Änderung der Schreibregion zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="e8655-121">Applications can use the WriteEndpoint property of DocumentClient class to detect the change in write region.</span></span>

<span data-ttu-id="e8655-122">Sobald die betroffene Region nach dem Ausfall wiederhergestellt wurde, werden alle betroffenen Cosmos DB-Konten in der Region vom Dienst automatisch wiederhergestellt.</span><span class="sxs-lookup"><span data-stu-id="e8655-122">Once the affected region recovers from the outage, all the affected Cosmos DB accounts in the region are automatically recovered by the service.</span></span>

<span data-ttu-id="e8655-123">Als Nächstes ändern wir die Leseregion für Ihre Datenbank.</span><span class="sxs-lookup"><span data-stu-id="e8655-123">Now let's modify the read region for your database.</span></span>

## <a name="set-read-region-priorities"></a><span data-ttu-id="e8655-124">Festlegen von Prioritäten für die Leseregion</span><span class="sxs-lookup"><span data-stu-id="e8655-124">Set read region priorities</span></span>

1. <span data-ttu-id="e8655-125">Klicken Sie im Azure-Portal auf dem Bildschirm **Daten global replizieren** auf **Automatisches Failover**.</span><span class="sxs-lookup"><span data-stu-id="e8655-125">In the Azure portal, on the **Replicate data globally** screen, click **Automatic Failover**.</span></span> <span data-ttu-id="e8655-126">Das automatische Failover wird nur aktiviert, wenn die Datenbank bereits in mehr als eine Region repliziert wurde.</span><span class="sxs-lookup"><span data-stu-id="e8655-126">Automatic failover is only enabled if the database has already been replicated to more than one region.</span></span>
2. <span data-ttu-id="e8655-127">Ändern Sie auf dem Bildschirm **Automatisches Failover** die Option **Automatisches Failover aktivieren** in **EIN**.</span><span class="sxs-lookup"><span data-stu-id="e8655-127">On the **Automatic Failover** screen, change **Enable Automatic Failover** to **ON**.</span></span>
3. <span data-ttu-id="e8655-128">Klicken Sie im Abschnitt **Leseregionen** auf den linken Teil der Zeile **USA, Osten**, und ziehen Sie ihn an die oberste Position.</span><span class="sxs-lookup"><span data-stu-id="e8655-128">In the **Read regions** section, click the left portion of the **East US** row, and then drag and drop at the top position.</span></span>
4. <span data-ttu-id="e8655-129">Klicken Sie auf den linken Teil der Zeile **Japan, Osten**, und ziehen Sie ihn an die zweite Position.</span><span class="sxs-lookup"><span data-stu-id="e8655-129">Click the left portion of the **Japan East** row, and then drag and drop to the second position.</span></span>
5. <span data-ttu-id="e8655-130">Klicken Sie auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="e8655-130">Click **OK**.</span></span>

    ![Ändern von Leseregionen im Portal](../media/4-change-priorities/change-read-priorities.gif)

## <a name="summary"></a><span data-ttu-id="e8655-132">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="e8655-132">Summary</span></span>

<span data-ttu-id="e8655-133">In dieser Einheit wurde beschrieben, was automatische Failover sind, wie Sie diese als Schutz vor unvorhergesehenen Ausfällen verwenden können und wie Sie die Prioritäten der Leseregion ändern.</span><span class="sxs-lookup"><span data-stu-id="e8655-133">In this unit, you've learned what automatic failover provides, how you can use it to protect against unforeseen outages, and how to modify read region priorities.</span></span>